(($,n,l)=>{'use strict';let a,c,h,r=l.createElement('div'),d=l.createElement('div'),p=r.classList,f=d.classList;const m=l.createElement('div'),y=themify_vars.theme_v,g=themifyScript.wc_css_url,u=t=>{27===t.keyCode&&_(t)},_=function(t){'keyup'!==t.type&&t.preventDefault(),a&&(m.tfOn('transitionend',function(t){const e=()=>{p.add('tf_hide'),d.innerHTML='',n.trigger('themiboxclosed'),l.body.classList.remove('post-lightbox'),l.tfOff('keyup',u,{passive:!0}),a=c=h=null};if(l.body.classList.remove('post-lightbox'),p.contains('lightbox-message'))p.remove('lightbox-message'),r.tfOn('transitionend',function(t){this.style.top='',e()},{passive:!0,once:!0}).style.top='150%';else{p.add('lightbox_closing','post-lightbox-prepare');const i=h.getBoundingClientRect();r.tfOn('transitionend',function(t){c.style.display='',f.remove('tf_hidden'),d.style.transition='',this.tfOn('transitionend',function(){this.classList.remove('post-lightbox-prepare','lightbox_closing'),e()},{passive:!0,once:!0}).style.top=i.top+i.height/2+'px',this.style.left=i.left+i.width/2+'px'},{passive:!0,once:!0}),d.style.transition='none',f.add('tf_hidden');for(let t=d.children,e=t.length-1;-1<e;--e)c!==t[e]&&t[e].remove();r.style.width=i.width+'px',r.style.height=i.height+'px'}this.classList.add('tf_hide')},{passive:!0,once:!0}),m.classList.add('tf_opacity'))},s=function(t){if(t.preventDefault(),a)return!1;if(a=this,n.wc(!0),!(h=(h=a.closest('.product,.slide-inner-wrap,.type-product'))&&h.querySelector('.product-image,.post-image')))return!1;p.add('woocommerce','woo_qty_btn','post-lightbox-prepare','tf_hide');let e=a.href,i=h.tfTag('img')[0];themify_vars.wc_js||(e=n.updateQueryString('load_wc','1',e)),i=(i=i?i.src:a.dataset.image)||themifyScript.placeholder,(c=new Image).src=i;const s=h.getBoundingClientRect(),o=n.fetch('','html',{method:'GET'},n.updateQueryString('post_in_lightbox','1',e));r.style.width=s.width+'px',r.style.height=s.height+'px',r.style.top=s.top+s.height/2+'px',r.style.left=s.left+s.width/2+'px',Promise.all([c.decode(),(()=>{let t=l.tfId('themify_concate-css');t=t&&t.nextElementSibling;const i=themifyScript.wc_gal,s=[];if(l.body.classList.contains('product-single')||s.push(n.loadCss(g+'single/product','theme_single_product',y,t)),s.push(n.loadCss(g+'lightbox','theme_lightbox',y)),0===l.tfClass('woocommerce-breadcrumb').length&&s.push(n.loadCss(g+'breadcrumb','theme_breadcrumb',y,t)),i)for(let e in i){let t=!1;'flexslider'===e||'zoom'===e?t=void 0!==$[e]:'photoswipe'===e?t='undefined'!=typeof PhotoSwipe:'photoswipe-ui-default'===e&&(t='undefined'!=typeof PhotoSwipeUI_Default),s.push(n.loadJs(i[e].s,t,i[e].v))}return Promise.all(s)})()]).then(()=>{d.appendChild(c),m.classList.remove('tf_hide'),p.remove('tf_hide'),setTimeout(()=>{r.tfOn('transitionend',t=>{l.body.classList.add('post-lightbox'),m.classList.remove('tf_opacity'),f.add('post-lightbox-flip-infinite'),o.then(t=>{n.on('single_slider_loaded',()=>{setTimeout(()=>{d.tfOn('animationiteration',function(){this.classList.remove('post-lightbox-flip-infinite'),r.tfOn('transitionend',t=>{if(r=i,d=s,f=d.classList,p=r.classList,r.style.top=i.style.left='',p.remove('tf_opacity'),r.previousSibling.remove(),r.style.transition='none',r.style.width=r.style.height=d.style.transition='','function'==typeof ThemifyShoppeAjaxCart){const e=d.querySelector('form.cart');e&&e.tfOn('submit',ThemifyShoppeAjaxCart)}i=s=null,f.remove('tf_opacity'),l.tfOn('keyup',u,{passive:!0}),setTimeout(()=>{r.style.transition='',r.lastElementChild.tfOn('click',_,{once:!0})},10)},{once:!0,passive:!0}).style.transition='',d.style.transition='none',f.add('tf_opacity'),p.remove('post-lightbox-prepare'),r.style.width=i.clientWidth+'px',r.style.height=i.clientHeight+'px'},{passive:!0,once:!0})},15)},!0);let i=r.cloneNode(!0),s=i.firstChild,e=(s.style.transition=i.style.transition='none',s.classList.remove('post-lightbox-flip-infinite'),i.classList.remove('post-lightbox-prepare'),i.classList.add('tf_opacity'),i.style.top=i.style.left='-1000vh',i.style.width=i.style.height='',(c=s.tfTag('img')[0]).style.display='none',s.appendChild(t),r.after(i),n.fonts(s),l.tfClass('pswp')[0]);if(e||(e=s.tfClass('pswp')[0])&&l.body.prepend(e),s.tfClass('share-wrap')[0]){let t=l.tfId('themify_concate-css');t=t&&t.nextElementSibling,n.loadCss(g+'social-share','theme_social_share',y,t)}n.trigger('themiboxloaded',s),n.wc(!0)})},{once:!0,passive:!0}),r.style.height='',r.style.width=(180<s.width?180:s.width)+'px',r.style.top=r.style.left=''},15)})};n.on('themify_theme_themibox_run',t=>{const e=l.createDocumentFragment(),i=l.createElement('a');r.id='post-lightbox-wrap',r.className='tf_scrollbar tf_box tf_hide',m.id='pattern',m.tfOn('click',_).className='tf_opacity tf_hide tf_w tf_h',d.id='post-lightbox-container',d.className='tf_box tf_w tf_h tf_overflow',i.className='close-lightbox tf_close',i.href='#',r.append(d,i),e.append(r,m),n.body.on('click','.themify-lightbox',s).on('added_to_cart',()=>{a&&(p.add('lightbox-message'),r.tfOn('transitionend',function(t){this.style.padding='',d.appendChild((()=>{const t=l.createElement('div'),e=l.createElement('h3'),i=l.createElement('a'),s=l.createElement('a');return t.className='tf_textc lightbox-added',e.textContent=themifyScript.lng.add_to,i.className='button outline',i.textContent=themifyScript.lng.keep_shop,i.tfOn('click',_,{once:!0}).href='#',s.href=themifyScript.checkout_url,s.className='button checkout',s.textContent=themifyScript.lng.checkout,t.append(e,i,s),t})()),this.tfOn('transitionend',function(t){this.style['max-height']=''},{passive:!0,once:!0}),this.style['max-height']='100%'},{passive:!0,once:!0}),d.innerHTML='',r.style.padding=r.style['max-height']='0px')})[0].appendChild(e),t.click()},!0)})(jQuery,Themify,document);