($=>{'use strict';function d(t){const e=t.parent();t.removeData('tfminicolors-initialized').removeData('tfminicolors-settings').removeProp('size').removeClass('tfminicolors-input'),e.before(t).remove()}function f(t){var e=t.parent(),i=e.find('.tfminicolors-panel'),s=t.data('tfminicolors-settings'),o=document.body.contains(t[0])?document:top.document;!t.data('tfminicolors-initialized')||t.prop('disabled')||e.hasClass('tfminicolors-inline')||e.hasClass('tfminicolors-focus')||(p(window.top.document),e.addClass('tfminicolors-focus'),i.animate?i.stop(!0,!0).fadeIn(s.showSpeed,function(){s.show&&s.show.call(t.get(0))}):(i.show(),s.show&&s.show.call(t.get(0))),$(o).on('mousedown.tfminicolors touchstart.tfminicolors',function(t){1===t.which&&0===$(t.target).closest('.tfminicolors,.tfminicolors_wrapper').length&&($(this).off('mousemove.tfminicolors touchmove.tfminicolors mousedown.tfminicolors touchstart.tfminicolors mouseup.tfminicolors touchend.tfminicolors'),p(this))}))}function p(t){$('.tfminicolors-focus',t).each(function(){const t=$(this),e=t.find('.tfminicolors-input'),i=t.find('.tfminicolors-panel'),s=e.data('tfminicolors-settings');i.animate?i.fadeOut(s.hideSpeed,function(){s.hide&&s.hide.call(e.get(0)),t.removeClass('tfminicolors-focus')}):(i.hide(),s.hide&&s.hide.call(e.get(0)),t.removeClass('tfminicolors-focus'))})}function m(t,e,i){let s=t.parents('.tfminicolors').find('.tfminicolors-input'),o=s.data('tfminicolors-settings'),a=t.find('[class$=-picker]'),n=t.offset().left,r=t.offset().top,c=Math.round(e.pageX-n),l=Math.round(e.pageY-r),h=i?o.animationSpeed:0,d,f,p,m,u;e.changedTouches&&(c=e.changedTouches[0].pageX-n,l=e.changedTouches[0].pageY-r),c<0&&(c=0),l<0&&(l=0),c>t.width()&&(c=t.width()),l>t.height()&&(l=t.height()),t.parent().hasClass('tfminicolors-slider-wheel')&&a.parent().hasClass('tfminicolors-grid')&&(d=75-c,f=75-l,p=Math.sqrt(d*d+f*f),(m=Math.atan2(f,d))<0&&(m+=2*Math.PI),75<p&&(c=75-75*Math.cos(m),l=75-75*Math.sin(m)),c=Math.round(c),l=Math.round(l)),u={top:l+'px'},t.is('.tfminicolors-grid')&&(u.left=c+'px'),a.animate?a.stop(!0).animate(u,h,o.animationEasing,function(){g(s,t)}):(a.css(u),g(s,t))}function g(t,e){function i(t,e){return t.length&&e?{x:t.offset().left-e.offset().left+t.outerWidth()/2,y:t.offset().top-e.offset().top+t.outerHeight()/2}:null}let s,o,a,n,r,c,l,h=t.val(),d=t.attr('data-opacity'),f=t.parent(),p=t.data('tfminicolors-settings'),m=f.find('.tfminicolors-input-swatch'),u=f.find('.tfminicolors-grid'),g=f.find('.tfminicolors-slider'),w=f.find('.tfminicolors-opacity-slider'),b=u.find('[class$=-picker]'),y=g.find('[class$=-picker]'),v=w.find('[class$=-picker]'),C=i(b,u),k=i(y,g),_=i(v,w);if(e.is('.tfminicolors-grid, .tfminicolors-slider, .tfminicolors-opacity-slider')){switch(p.control){case'wheel':n=u.width()/2-C.x,r=u.height()/2-C.y,c=Math.sqrt(n*n+r*r),(l=Math.atan2(r,n))<0&&(l+=2*Math.PI),75<c&&(c=75,C.x=69-75*Math.cos(l),C.y=69-75*Math.sin(l)),o=I(c/.75,0,100),s=I(180*l/Math.PI,0,360),a=I(100-Math.floor(100*k.y/g.height()),0,100),h=F({h:s,s:o,b:a}),g.css('backgroundColor',F({h:s,s:o,b:100}));break;case'saturation':s=I(parseInt(360*C.x/u.width(),10),0,360),o=I(100-Math.floor(100*k.y/g.height()),0,100),a=I(100-Math.floor(100*C.y/u.height()),0,100),h=F({h:s,s:o,b:a}),g.css('backgroundColor',F({h:s,s:100,b:a})),f.find('.tfminicolors-grid-inner').css('opacity',o/100);break;case'brightness':s=I(parseInt(360*C.x/u.width(),10),0,360),o=I(100-Math.floor(100*C.y/u.height()),0,100),a=I(100-Math.floor(100*k.y/g.height()),0,100),h=F({h:s,s:o,b:a}),g.css('backgroundColor',F({h:s,s:o,b:100})),f.find('.tfminicolors-grid-inner').css('opacity',1-a/100);break;default:s=I(360-parseInt(360*k.y/g.height(),10),0,360),o=I(Math.floor(100*C.x/u.width()),0,100),a=I(100-Math.floor(100*C.y/u.height()),0,100),h=F({h:s,s:o,b:a}),u.css('backgroundColor',F({h:s,s:100,b:100}));break}d=p.opacity?parseFloat(1-_.y/w.height()).toFixed(2):1,S(t,h,d)}else m.find('span').css({backgroundColor:h,opacity:d}),M(t,h,d)}function S(t,e,i){let s,o=t.parent(),a=t.data('tfminicolors-settings'),n=o.find('.tfminicolors-input-swatch');a.opacity&&t.attr('data-opacity',i),e='rgb'===a.format?(s=j(e)?N(e,!0):L(x(e,!0)),i=''===t.attr('data-opacity')?1:I(parseFloat(t.attr('data-opacity')).toFixed(2),0,1),!isNaN(i)&&a.opacity||(i=1),t.tfminicolors('rgbObject').a<=1&&s&&a.opacity?'rgba('+s.r+', '+s.g+', '+s.b+', '+parseFloat(i)+')':'rgb('+s.r+', '+s.g+', '+s.b+')'):_(e=j(e)?T(e):e,a.letterCase),t.val(e),n.find('span').css({backgroundColor:e,opacity:i}),o.removeClass('tfminicolors-var-input'),M(t,e,i)}function u(t,e){let i,s,o,a,n,r,c,l;const h=t.parent(),d=t.data('tfminicolors-settings'),f=h.find('.tfminicolors-input-swatch'),p=h.find('.tfminicolors-grid'),m=h.find('.tfminicolors-slider'),u=h.find('.tfminicolors-opacity-slider'),g=p.find('[class$=-picker]'),w=m.find('[class$=-picker]'),b=u.find('[class$=-picker]'),y=t.val(),v=(j(y)?(i=T(y),(o=I(parseFloat(D(y)).toFixed(2),0,1))&&t.attr('data-opacity',o)):i=_(x(y,!0),d.letterCase),function(t){t=L(t),i={h:0,s:0,b:0},s=Math.min(t.r,t.g,t.b),o=Math.max(t.r,t.g,t.b),s=o-s,i.b=o,i.s=0!==o?255*s/o:0,0!==i.s?t.r===o?i.h=(t.g-t.b)/s:t.g===o?i.h=2+(t.b-t.r)/s:i.h=4+(t.r-t.g)/s:i.h=-1,i.h*=60,i.h<0&&(i.h+=360),i.s*=100/255,i.b*=100/255;const e=i;var i,s,o;return 0===e.s&&(e.h=360),e}(i=i||_(E(d.defaultValue,!0),d.letterCase))),C=d.keywords?$.map(d.keywords.split(','),function(t){return $.trim(t.toLowerCase())}):[],k=''!==y&&0===y.indexOf('--');switch(''!==y&&(1==k||-1<$.inArray(y.toLowerCase(),C))?(a=_(y),1==k&&h.addClass('tfminicolors-var-input')):(a=j(y)?N(y):i,h.removeClass('tfminicolors-var-input')),e||t.val(a),d.opacity&&(s=''===t.attr('data-opacity')?1:I(parseFloat(t.attr('data-opacity')).toFixed(2),0,1),isNaN(s)&&(s=1),t.attr('data-opacity',s),f.find('span').css('opacity',s),r=I(u.height()-u.height()*s,0,u.height()),b.css('top',r+'px')),'transparent'===y.toLowerCase()&&f.find('span').css('opacity',0),f.find('span').css('backgroundColor',i),d.control){case'wheel':c=I(Math.ceil(.75*v.s),0,p.height()/2),l=v.h*Math.PI/180,n=I(75-Math.cos(l)*c,0,p.width()),r=I(75-Math.sin(l)*c,0,p.height()),g.css({top:r+'px',left:n+'px'}),r=150-v.b/100*p.height(),''===i&&(r=0),w.css('top',r+'px'),m.css('backgroundColor',F({h:v.h,s:v.s,b:100}));break;case'saturation':n=I(5/12*v.h,0,150),r=I(p.height()-Math.ceil(v.b/100*p.height()),0,p.height()),g.css({top:r+'px',left:n+'px'}),r=I(m.height()-v.s*m.height()/100,0,m.height()),w.css('top',r+'px'),m.css('backgroundColor',F({h:v.h,s:100,b:v.b})),h.find('.tfminicolors-grid-inner').css('opacity',v.s/100);break;case'brightness':n=I(5/12*v.h,0,150),r=I(p.height()-Math.ceil(v.s/100*p.height()),0,p.height()),g.css({top:r+'px',left:n+'px'}),r=I(m.height()-v.b*m.height()/100,0,m.height()),w.css('top',r+'px'),m.css('backgroundColor',F({h:v.h,s:v.s,b:100})),h.find('.tfminicolors-grid-inner').css('opacity',1-v.b/100);break;default:n=I(Math.ceil(v.s/100*p.width()),0,p.width()),r=I(p.height()-Math.ceil(v.b/100*p.height()),0,p.height()),g.css({top:r+'px',left:n+'px'}),r=I(m.height()-v.h/360*m.height(),0,m.height()),w.css('top',r+'px'),p.css('backgroundColor',F({h:v.h,s:100,b:100}));break}t.data('tfminicolors-initialized')&&M(t,a,s)}function M(t,e,i){let s=t.data('tfminicolors-settings'),o=t.data('tfminicolors-lastChange'),a,n,r;if(!o||o.value!==e||o.opacity!==i){if(t.data('tfminicolors-lastChange',{value:e,opacity:i}),s.swatches&&0!==s.swatches.length){for(a=j(e)?N(e,!0):L(e),n=-1,r=0;r<s.swatches.length;++r)if(a.r===s.swatches[r].r&&a.g===s.swatches[r].g&&a.b===s.swatches[r].b&&a.a===s.swatches[r].a){n=r;break}t.parent().find('.tfminicolors-swatches .tfminicolors-swatch').removeClass('selected'),-1!==n&&t.parent().find('.tfminicolors-swatches .tfminicolors-swatch').eq(r).addClass('selected')}s.change&&(s.changeDelay?(clearTimeout(t.data('tfminicolors-changeTimeout')),t.data('tfminicolors-changeTimeout',setTimeout(function(){s.change.call(t.get(0),e,i)},s.changeDelay))):s.change.call(t.get(0),e,i)),t.trigger('change').trigger('input')}}function _(t,e){return'uppercase'===e?t.toUpperCase():t.toLowerCase()}function x(t,e){return!(t=t.replace(/^#/g,'')).match(/^[A-F0-9]{3,6}/gi)||3!==t.length&&6!==t.length?'':'#'+(t=3===t.length&&e?t[0]+t[0]+t[1]+t[1]+t[2]+t[2]:t)}function N(t,e){t=t.replace(/[^\d,.]/g,'').split(',');return t[0]=I(parseInt(t[0],10),0,255),t[1]=I(parseInt(t[1],10),0,255),t[2]=I(parseInt(t[2],10),0,255),void 0!==t[3]&&(t[3]=I(parseFloat(t[3],10),0,1)),e?void 0!==t[3]?{r:t[0],g:t[1],b:t[2],a:t[3]}:{r:t[0],g:t[1],b:t[2]}:void 0!==t[3]&&t[3]<=1?'rgba('+t[0]+', '+t[1]+', '+t[2]+', '+t[3]+')':'rgb('+t[0]+', '+t[1]+', '+t[2]+')'}function E(t,e){return j(t)?N(t):x(t,e)}function I(t,e,i){return t<e?t=e:i<t&&(t=i),t}function j(t){const e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e&&4===e.length}function D(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i))&&6===t.length?t[4]:'1'}function T(t){return(t=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===t.length?'#'+('0'+parseInt(t[1],10).toString(16)).slice(-2)+('0'+parseInt(t[2],10).toString(16)).slice(-2)+('0'+parseInt(t[3],10).toString(16)).slice(-2):''}function w(t){var i=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return $.each(i,function(t,e){1===e.length&&(i[t]='0'+e)}),'#'+i.join('')}function F(t){return w((t=t,i={},s=Math.round(t.h),o=Math.round(2.55*t.s),t=Math.round(2.55*t.b),0===o?i.r=i.g=i.b=t:(t=s%60*((e=t)-(o=(255-o)*t/255))/60,(s=360===s?0:s)<60?(i.r=e,i.b=o,i.g=o+t):s<120?(i.g=e,i.b=o,i.r=e-t):s<180?(i.g=e,i.r=o,i.b=o+t):s<240?(i.b=e,i.r=o,i.g=e-t):s<300?(i.b=e,i.g=o,i.r=o+t):s<360?(i.r=e,i.g=o,i.b=e-t):(i.r=0,i.g=0,i.b=0)),{r:Math.round(i.r),g:Math.round(i.g),b:Math.round(i.b)}));var e,i,s,o}function L(t){return{r:(t=parseInt(-1<t.indexOf('#')?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}$.tfminicolors={defaults:{animationSpeed:50,animationEasing:'swing',change:null,changeDelay:0,control:'hue',defaultValue:'',format:'hex',hide:null,hideSpeed:100,inline:!1,keywords:'',letterCase:'lowercase',opacity:!1,position:'bottom',show:null,showSpeed:100,theme:'default',swatches:[]}},$.extend($.fn,{tfminicolors(e,h){switch(e){case'destroy':return $(this).each(function(){d($(this))}),$(this);case'hide':return p(),$(this);case'opacity':return void 0===h?$(this).attr('data-opacity'):($(this).each(function(){u($(this).attr('data-opacity',h))}),$(this));case'rgbObject':{var i=$(this);const t=$(i),o=t.attr('data-opacity'),a=t.val(),n=j(a)?N(a,!0):L(x(a,!0));return n?(void 0!==o&&$.extend(n,{a:parseFloat(o)}),n):null;return}case'rgbString':case'rgbaString':{var i=$(this),s='rgbaString'===e;const r=$(i),c=r.val(),l=j(c)?N(c,!0):L(x(c,!0));let t=r.attr('data-opacity');return l?(void 0===t&&(t=1),s?'rgba('+l.r+', '+l.g+', '+l.b+', '+parseFloat(t)+')':'rgb('+l.r+', '+l.g+', '+l.b+')'):null;return}case'settings':return void 0===h?$(this).data('tfminicolors-settings'):($(this).each(function(){var t=$(this).data('tfminicolors-settings')||{};d($(this)),$(this).tfminicolors($.extend(!0,t,h))}),$(this));case'show':return f($(this).eq(0)),$(this);case'value':return void 0===h?$(this).val():($(this).each(function(){'object'==typeof h&&null!==h?(void 0!==h.opacity&&$(this).attr('data-opacity',I(h.opacity,0,1)),h.color&&$(this).val(h.color)):$(this).val(h),u($(this))}),$(this));default:return'create'!==e&&(h=e),$(this).each(function(){var t,e,i,s,o,r=$(this),a=h,n=$('<div class="tfminicolors" />'),c=$.tfminicolors.defaults;if(!r.data('tfminicolors-initialized')){a=$.extend(!0,{},c,a),n.addClass('tfminicolors-theme-'+a.theme).addClass(a.opacity?'tfminicolors-with-opacity':'tfminicolors-without-opacity'),void 0!==a.position&&$.each(a.position.split(' '),function(){n.addClass('tfminicolors-position-'+this)}),c='rgb'===a.format?a.opacity?'25':'20':a.keywords?'11':'7',r.addClass('tfminicolors-input').data('tfminicolors-initialized',!1).data('tfminicolors-settings',a).prop('size',c).attr({autocomplete:'off',placeholder:' '}).wrap(n).after('<div class="tfminicolors-panel tfminicolors-slider-'+a.control+"\"><div class=\"tfminicolors-slider tfminicolors-sprite\"><div class=\"tfminicolors-picker\"></div></div><div class=\"tfminicolors-opacity-slider tfminicolors-sprite\"><div class=\"tfminicolors-picker\"></div></div><div class=\"tfminicolors-grid tfminicolors-sprite\"><div class=\"tfminicolors-grid-inner tf_abs tf_w tf_h\"></div><div class=\"tfminicolors-picker\"><div></div></div></div></div>"),a.inline||r.after('<span class="tfminicolors-swatch tfminicolors-input-swatch"><span class="tfminicolors-swatch-color tf_abs"></span></span>'),r.after('<div class="tfminicolors_clear_btn tf_close"></div>'),r.on('focus.tfminicolors blur.tfminicolors keydown.tfminicolors keyup.tfminicolors paste.tfminicolors',function(t){var e=t.type;if('focus'!==e||r.parent().hasClass('tfminicolors-var-input'))if('blur'===e){const a=r.data('tfminicolors-settings');let t,e,i,s,o=r.val();if(r.data('tfminicolors-initialized')){const n=a.keywords?$.map(a.keywords.split(','),function(t){return t.toLowerCase().trim()}):[];s=''!==o&&(0===o.indexOf('--')||-1<n.indexOf(o.toLowerCase()))?o:(console.log(o),null===(e=j(o='transparent'===o?'rgba(0,0,0,0)':o)?N(o,!0):(t=x(o,!0))?L(t):null)?a.defaultValue:'rgb'===a.format?a.opacity?N('rgba('+e.r+','+e.g+','+e.b+','+r.attr('data-opacity')+')'):N('rgb('+e.r+','+e.g+','+e.b+')'):w(e)),i=a.opacity?r.attr('data-opacity'):1,'transparent'===s.toLowerCase()&&(i=0),r.closest('.tfminicolors').find('.tfminicolors-input-swatch > span').css('opacity',i),r.val(s),''===o&&r.val(E(a.defaultValue,!0)),r.val(_(o,a.letterCase))}}else if('keydown'===e)switch(t.which){case 9:p();break;case 13:case 27:p(),r.blur();break}else'keyup'!==e&&'paste'!==e||('keyup'===e?u(r,!0):setTimeout(()=>{u(r,!0)},1));else f(r)});const l=r.closest('.tfminicolors');if(l.on('click.tfminicolors','.tfminicolors-swatches li',function(t){t.preventDefault();var t=$(this),e=t.parents('.tfminicolors').find('.tfminicolors-input'),t=t.data('swatch-color');S(e,t,D(t)),u(e)}).find('.tfminicolors-input-swatch').on('click mousedown.tfminicolors touchstart.tfminicolors',function(t){if('click'===t.type)a.inline||r.focus();else{if(1!==t.which)return;f(r)}t.preventDefault()}),l[0].addEventListener('pointerdown',t=>{if(1===t.which){const e=t.target.closest('.tfminicolors-grid, .tfminicolors-slider, .tfminicolors-opacity-slider');if(e){const i=$(e),s=t=>{m(i,t)};m(i,t,!0),e.addEventListener('pointermove',s,{passive:!0}),e.addEventListener('lostpointercapture',function(){this.removeEventListener('pointermove',s,{passive:!0})},{passive:!0,once:!0}),e.setPointerCapture(t.pointerId)}}},{passive:!0}),l[0].getElementsByClassName('tfminicolors_clear_btn')[0].addEventListener('click',function(t){console.log(r),t.stopPropagation(),S(r,'',1)},{passive:!0}),(c=r.parent().find('.tfminicolors-panel')).on('selectstart',function(){return!1}).end(),a.swatches&&0!==a.swatches.length)for(c.addClass('tfminicolors-with-swatches'),e=$('<ul class="tfminicolors-swatches tf_scrollbar"></ul>').appendTo(c),o=0;o<a.swatches.length;++o)i=j(s=i='object'==typeof a.swatches[o]?(t=a.swatches[o].name,a.swatches[o].color):(t='',a.swatches[o]))?N(i,!0):L(x(i,!0)),$('<li class="tfminicolors-swatch"><span class="tfminicolors-swatch-color tf_abs" title="'+t+'"></span></li>').appendTo(e).data('swatch-color',s).find('.tfminicolors-swatch-color').css({backgroundColor:w(i),opacity:i.a}),a.swatches[o]=i;a.inline&&r.parent().addClass('tfminicolors-inline'),u(r,!1),r.data('tfminicolors-initialized',!0)}}),$(this)}}})})(jQuery),(($,t,l)=>{'use strict';t.themifyColorManager={colorSwatches:{},initilized:!1,init(){if(!this.initilized&&'undefined'!=typeof themifyCM){this.initilized=!0;for(let t=Object.keys(themifyCM.colors),e=0,i=t.length;e<i;++e)this.colorSwatches[t[e]]=themifyCM.colors[t[e]]}},toRgba(t){return t.color.replace('rgb','rgba').replace(')',','+t.opacity+')')},toColorsArray(){let i=[];for(let t=Object.keys(this.colorSwatches),e=t.length-1;-1<e;--e)i.push(this.toRgba(this.colorSwatches[t[e]]));return i=i.length?i:['#FFF']},initColorPicker(t){const e=t.closest('.tfminicolors').querySelector('.tfminicolors-focus .tfminicolors-panel');if(!e.getElementsByClassName('tf_swatches_container')[0]){const i=l.createElement('div'),s=i.getElementsByClassName('tfminicolors-swatch'),o=Object.keys(this.colorSwatches).reverse(),a=l.createElement('div'),n=l.createElement('span'),r=l.createElement('span'),c=l.createElement('div');i.className='tf_swatches_container',i.addEventListener('click',this.initClick.bind(this)),i.appendChild(e.getElementsByClassName('tfminicolors-swatches')[0]);for(let i=s.length-1;-1<i;--i){if(!o.length){s[i].parentNode.removeChild(s[i]);break}let t=l.createElement('span'),e=void 0!==this.colorSwatches[o[i]].uid?this.colorSwatches[o[i]].uid:this.UID()+i;t.className='tf_delete_swatch tf_close',s[i].appendChild(t),s[i].dataset.uid=this.colorSwatches[o[i]].uid=e}r.className=n.className='tf_cm_tooltip',n.innerText=themifyCM.labels.save,a.appendChild(n),a.className='tf_add_swatch tf_plus_icon',a.setAttribute('tabIndex','-1'),i.appendChild(a),r.innerText=themifyCM.labels.ie,c.className='tf_cm_dropdown_icon',c.setAttribute('tabIndex','-1'),c.append(r,this.getIcon('ti-import'),this.makeImportExportDropdown()),i.appendChild(c),e.appendChild(i)}},makeImportExportDropdown(){const t=l.createElement('div'),e=l.createElement('ul'),i=l.createElement('li'),s=l.createElement('li');return t.className='tf_cm_dropdown',i.className='tb_cm_import',i.append(this.getIcon('ti-import'),l.createTextNode(themifyCM.labels.import)),s.className='tb_cm_export',s.append(this.getIcon('ti-export'),l.createTextNode(themifyCM.labels.export)),e.append(i,s),t.appendChild(e),t},getIcon(t,e){t='tf-'+t.trim().replace(' ','-');const i='http://www.w3.org/2000/svg',s=l.createElementNS(i,'use'),o=l.createElementNS(i,'svg');let a='tf_fa '+t;return e&&(a+=' '+e),o.setAttribute('class',a),s.setAttributeNS(null,'href','#'+t),o.appendChild(s),o},UID(){const t=Math.random().toString(36).substring(2)+(new Date).getTime().toString(36);return t.substring(0,5)},initClick(t){t.preventDefault();const e=t.target,i=e.classList;i.contains('tf_delete_swatch')?this.deleteSwatch(t):i.contains('tf_add_swatch')?this.addSwatch(e.ownerDocument):i.contains('tb_cm_export')?(e.parentNode.parentNode.parentNode.blur(),l.location.assign(themifyCM.exportColorsURL)):i.contains('tb_cm_import')&&(e.parentNode.parentNode.parentNode.blur(),this.importColors('colors',e.ownerDocument))},importColors(t,e){let i=(e=e||l).getElementsByClassName('themify_cm_input')[0];if(i)i.dataset.type=t;else{(i=l.createElement('input')).type='file',i.dataset.type=t,i.className='themify_cm_input';const a=this;i.addEventListener('change',function(t){const e=t.target.files[0],i=new FormData,o=t.target.dataset.type;i.set('file',e,e.name),i.set('action','themify_import_colors'),i.set('nonce',themifyCM.nonce),i.set('type',o),$.ajax({url:themifyCM.ajax_url,type:'POST',data:i,cache:!1,dataType:'json',processData:!1,contentType:!1,success(t){if('SUCCESS'===t.status)if('colors'===o){a.colorSwatches=t.colors;for(let t=l.querySelectorAll('.tf_swatches_container .tfminicolors-swatch'),e=t.length-1;-1<e;--e)t[e].parentNode.removeChild(t[e]);for(let t=Object.keys(a.colorSwatches),e=t.length,i=0;i<e;i++)a.addSwatchHtml(l,a.colorSwatches[t[i]].color,a.colorSwatches[t[i]].opacity,t[i])}else if('gradients'===o){const s=$(tb_app.LightBox.el.querySelector('.tb_gradient_container')).data('themifyGradient');for(let t=Object.keys(themifyCM.gradients),e=t.length-1;-1<e;--e)s.removeSwatch(t[e]);themifyCM.gradients=t.colors;for(let t=Object.keys(themifyCM.gradients),e=0,i=t.length;e<i;++e)s.addSwatch(themifyCM.gradients[t[e]])}alert(t.msg)}})})}i.click()},deleteSwatch(i){i.preventDefault(),i.stopPropagation();const s=i.target.parentNode.dataset.uid;for(let t=i.target.ownerDocument.querySelectorAll('[data-uid="'+s+'"]'),e=t.length-1;-1<e;--e)t[e].parentNode.removeChild(t[e]);delete this.colorSwatches[s],this.updateColorSwatches('colors')},updateColorSwatches(t){$.ajax({type:'POST',url:themifyCM.ajax_url,dataType:'json',data:{action:'themify_save_colors',type:t,nonce:themifyCM.nonce,colors:'colors'===t?this.colorSwatches:themifyCM.gradients}})},addSwatch(t){const e=t.querySelector('.tfminicolors-focus .tfminicolors-input'),i=this.hex2Rgb(e.value),s=e.dataset.opacity;if(null===i)return!1;for(let t=Object.keys(this.colorSwatches),e=t.length-1;-1<e;--e)if(this.colorSwatches[t[e]].color.replace(/\s/g,'')===i&&parseFloat(this.colorSwatches[t[e]].opacity)===parseFloat(s))return!1;const o=this.UID();this.addSwatchHtml(t,i,s,o),this.colorSwatches[o]={color:i,opacity:s,uid:o},this.updateColorSwatches('colors')},addSwatchHtml(o,a,n,i){for(let t=o.querySelectorAll('.tf_swatches_container .tfminicolors-swatches'),e=t.length-1;-1<e;--e)t[e].insertBefore((t=>{const e=o.createElement('li'),i=o.createElement('span'),s=o.createElement('span');return e.className='tfminicolors-swatch tfminicolors-sprite',e.dataset.uid=t,e.dataset.swatchColor=a.replace(')',', '+n+')').replace('rgb','rgba'),i.className='tfminicolors-swatch-color tf_abs',i.style.backgroundColor=a,i.style.opacity=n,s.className='tf_delete_swatch tf_close',e.append(i,s),e})(i),t[e].firstChild)},hex2Rgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?'rgb('+parseInt(e[1],16)+','+parseInt(e[2],16)+','+parseInt(e[3],16)+')':null}},t.themifyColorManager.init()})(jQuery,window,document);