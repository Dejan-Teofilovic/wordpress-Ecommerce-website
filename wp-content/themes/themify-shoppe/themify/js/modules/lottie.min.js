let TF_Lottie;((t,n,e)=>{'use strict';const o=new Map;class i extends HTMLElement{async init(){const t=this.tfTag('template')[0],e=t?t.content.textContent:this.dataset.args;if(t&&t.remove(),e){const i=new TF_Lottie(this,JSON.parse(e));await i.run()}}connectedCallback(){this.dataset.lazy||this.init()}attributeChangedCallback(t,e,i){i||'data-lazy'!==t||this.init()}disconnectedCallback(){const e=lottie.getRegisteredAnimations(),i=this.dataset.id;for(let t=e.length-1;-1<t;--t)if(e[t].animationID===i){e[t].destroy();break}}}i.observedAttributes=['data-lazy'],TF_Lottie=class{constructor(t,e){this.el=t,this.actions=e.actions,this.loop=!!e.loop,this.index=0}destroy(){this.player&&(this.player.destroy(),this.el=this.player=this.actions=null)}loadChain(){const r=[];for(let s=this.index,a=0,t=this.actions.length;s<t;++s){let t=this.actions[s],e=t.data||o.get(t.path),i=s<1;if(e)r.push(JSON.parse(JSON.stringify(e)));else{if(!1===i){if(2<++a)break;1===a&&(i=!0)}!0===i&&r.push((async t=>{let e=o.get(t);return e||(e=await n.fetch('',null,{credentials:'omit',method:'GET',mode:'cors',headers:{'Content-Type':'application/zip'}},t),o.set(t,e)),e})(t.path))}}return r}run(){return new Promise(async t=>{this.action=this.actions[this.index];const e=await Promise.all([n.loadJs('https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.0/lottie_light.min.js',!!window.lottie,!1),...this.loadChain()]),i=()=>{this.player.removeEventListener('DOMLoaded',i),this.init(),this.el.style.height='',this.el.dataset.id=this.player.animationID,t()};this.el.style.height=parseFloat(this.el.getBoundingClientRect().width/parseFloat(e[1].w/e[1].h))+'px',this.player&&this.player.destroy(),this.player=window.lottie.loadAnimation({container:this.el,animationData:e[1],renderer:'svg',loop:!1,autoplay:!1,rendererSettings:{progressiveLoad:!0}}),this.player.addEventListener('DOMLoaded',i)})}async init(){const t=this.action,e=this.player,i=t.state;t.fr_id&&t.fr_id.trim(),t.fr_id&&(t.fr_id=0<e.markers.length?t.fr_id.trim():'',''!==t.fr_id&&e.getMarkerData(t.fr_id)?e.goToAndStop(t.fr_id,!1):t.fr_id=null),t.tr=t.tr.charAt(0).toUpperCase()+t.tr.slice(1),t.count=0<t.count?parseInt(t.count):1,t.dir=parseInt(t.dir)<0?-1:1,e.setSpeed(0<t.speed?parseFloat(t.speed):1),e.loop=!1,e.setDirection(t.dir),-1===t.dir&&e.goToAndStop(e.totalFrames,!t.fr_id),await this[i](),this.loadChain(),'Autoplay'!==t.tr&&await this['tr'+t.tr](),await this.loadNext()}async autoplay(){const t=this.player.loop;this.player.loop=!0;for(let t=this.action.count-1;-1<t;--t)await this.play();1<this.actions.length&&(this.player.loop=t)}click(a){return new Promise(e=>{let i=0;const t=a||n.click,s=async t=>{++i>=this.action.count&&(this.el.tfOff(t.type,s,{passive:!1}),await this.play(),e())};this.el.tfOn(t,s,{passive:!1}),'click'!==a&&this.player.isPaused&&this.el.matches(':hover')&&n.triggerEvent(this.el,t)})}hover(){return this.click('pointerenter')}hold(a){return new Promise(e=>{const i=async t=>{if(this.player.trigger('reject'),this.player.pause(),'pausehold'!==a){this.player.setDirection(-1*this.player.playDirection);try{await this.play()}catch(t){}}},s=async t=>{try{this.player.trigger('reject'),this.player.setDirection(this.action.dir),this.el.tfOn('pointerleave',i,{passive:!1,once:!0}),await this.play(),this.el.tfOff(t.type,s,{passive:!1}).tfOff('pointerleave',i,{passive:!1,once:!0}),e()}catch(t){}};this.el.tfOn('pointerenter',s,{passive:!1}),this.player.isPaused&&this.el.matches(':hover')&&n.triggerEvent(this.el,'pointerenter')})}pausehold(){return this.hold('pausehold')}trHover(){return this.hover()}trClick(){return this.click()}async loadNext(){if(1<this.actions.length){if(++this.index,this.loadChain(),this.index>=this.actions.length){if(!0!==this.loop)return;this.index=0}await this.run()}}play(){return new Promise((r,n)=>{requestAnimationFrame(()=>{const t=0<this.action.delay?1e3*parseFloat(this.action.delay):0,e=this.player.loop?'loopComplete':'complete',i=()=>{this.player.removeEventListener(e,i),this.player.removeEventListener('reject',s),r()},s=()=>{this.player.removeEventListener('reject',s),this.player.removeEventListener(e,i),n()},a=()=>{this.player.addEventListener(e,i),this.player.addEventListener('reject',s),this.action.fr_id?this.player.goToAndPlay(this.action.fr_id,!1):this.player.play()};0<t?setTimeout(()=>{a()},t):a()})})}},customElements.define('tf-lottie',i)})(document,Themify);export{TF_Lottie};