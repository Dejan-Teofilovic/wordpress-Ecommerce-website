((n,p,g)=>{'use strict';let h;const r=new Map,c=e=>{const t=e.parentNode;let a=t.dataset.gap;if(a)a=parseInt(a);else{const s=getComputedStyle(t);a=-1!==s.getPropertyValue('grid-template-columns').trim().indexOf(' ')?parseInt(s.getPropertyValue('grid-row-gap')):-1,t.dataset.gap=a}if(0<a){const n=e.tfClass('predesigned_image')[0].getBoundingClientRect().height+e.tfClass('predesigned_title')[0].getBoundingClientRect().height;e.style.gridRowEnd='span '+Math.ceil((n+a)/a)}},m=new IntersectionObserver((i,o)=>{for(let l=i.length-1;-1<l;--l)if(!0===i[l].isIntersecting){o.unobserve(i[l].target);let e=i[l].target,t=e.parentNode,a=new Image(500,300),s=g.createElement('div'),n=e.tfTag('img')[0],r=n.dataset.src;s.className='tf_loader tf_abs_c',a.decoding='async',a.src=r,a.title=a.alt=n.alt,e.appendChild(s),c(t),a.decode().catch(()=>{}).finally(()=>{n.replaceWith(a),s.remove(),requestAnimationFrame(()=>{c(t)})})}},{threshold:.1});n.preDesignedRows=class{constructor(e){e.removeAttribute('data-gap'),this.el=e,h?this.init():p.fetch('',null,{credentials:'omit',method:'GET',mode:'cors',headers:{'Content-Type':'application/json'}},themifyBuilder.paths.rows_index).then(e=>{h=e,this.init()},e=>{n.Spinner.showLoader('error'),this.el.innerHTML='<h3 class="tf_textc">'+ThemifyConstructor.label.rows_fetch_error+'</h3>'})}init(){const e=-1!==g.createElement('canvas').toDataURL('image/webp').indexOf('data:image/webp')?'webp':'png',o="//via.placeholder.com/500x300."+e+'?text=',c=g.createDocumentFragment(),a=g.createDocumentFragment(),s=this.el.closest('.panel_tab').querySelector('.dropdown_wrap ul'),d=[];for(let i=0,e=h.length;i<e;++i){let e=h[i],s=[];if(e.category){let a=e.category.split(',');for(let e=0,t=a.length;e<t;++e)''!==a[e]&&(-1===d.indexOf(a[e])&&d.push(a[e]),s.push('tb'+p.hash(a[e])))}let t=g.createElement('div'),a=g.createElement('figure'),n=g.createElement('div'),r=new Image(500,300),l=g.createElement('button');t.className='predesigned_row tf_w',0<s.length&&(t.className+=' '+s.join(' ')),t.draggable=!0,t.dataset.slug=e.slug,a.className='predesigned_image tf_rel',n.className='predesigned_title',n.textContent=r.alt=r.title=e.title,r.loading='lazy',r.decoding='async',r.src=o+encodeURI(e.title),e.thumbnail&&(r.dataset.src=e.thumbnail,m.observe(a)),l.type='button',l.className='tf_plus_icon add_module_btn tb_disable_sorting tf_rel',l.dataset.type='predesigned',a.append(r,l),t.append(a,n),c.appendChild(t)}d.sort();for(let t=0,e=d.length;t<e;++t){let e=g.createElement('li');e.textContent=d[t],e.dataset.slug='tb'+p.hash(d[t]),a.appendChild(e)}this.el.appendChild(c),s.appendChild(a),p.imagesLoad(this.el).then(e=>{s.tfOn(p.click,e=>{this.filter(e)}).parentNode.classList.remove('tf_hidden');const t=this.el.tfClass('tf_loader')[0];t&&t.remove()})}filter(e){e.preventDefault(),e.stopPropagation();const a=e.target;if(!a.classList.contains('current')){const t=a.dataset.slug,s=a.closest('.panel_tab'),n=s.tfClass('dropdown_label')[0],r=t||0;n.innerText=a.textContent,n.dataset.active=r,e.isTrusted&&(s.closest('.panel_container').tfClass('panel_search')[0].value='');for(let e=a.parentNode.children,t=e.length-1;-1<t;--t)e[t].classList.toggle('current',e[t]===a);for(let e=s.tfClass('predesigned_row'),t=e.length-1;-1<t;--t)e[t].style.display=!r||e[t].classList.contains(r)?'':'none'}}},n.preDesignedRows.get=async e=>{if(n.Spinner.showLoader(),r.has(e))return r.get(e);try{const t=await p.fetch('',null,{credentials:'omit'},themifyBuilder.paths.row_template.replace('{SLUG}',e));if(n.Helper.clearElementId(t),r.set(e,t),-1===JSON.stringify(t).indexOf(n.GS.key))return t;try{const a=await p.fetch('',null,{credentials:'omit'},themifyBuilder.paths.row_template.replace('{SLUG}',e+'-gs')),s={};for(let e in a)void 0!==a[e].class?s[a[e].class]=a[e]:s[e]=a[e];return n.GS.setImport(s,t)}catch(e){return t}}catch(e){n.Spinner.showLoader('error'),n.LiteLightBox.alert(ThemifyConstructor.label.row_fetch_error)}}})(tb_app,Themify,document);