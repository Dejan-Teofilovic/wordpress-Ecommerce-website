((_,b,r,h,u)=>{'use strict';_.LightBox={storageKey:'visual'===_.mode?'themify_builder_lightbox_frontend_pos_size':'themify_builder_lightbox_backend_pos_size',size:null,isStandalone:!1,el:null,init(){r.document.body.appendChild(h.tfId('tmpl-builder_lightbox').content),this.el=r.document.tfId('tb_lightbox_parent'),this.firstRun(),_.Forms.initValidators()},firstRun(){if(b.on('tb_opened_lightbox',()=>{this.el.tfClass('tb_close_lightbox')[0].tfOn(b.click,()=>{this.close()},{passive:!0}),this.el.tfClass('builder_cancel_docked_mode')[0].tfOn(b.click,t=>{t.preventDefault(),t.stopPropagation(),_.Dock.close(!1),this.updateStorage(),_.MainPanel.updateStorage()}),!1===this.isStandalone&&(this.updateStorage(),this.setupLightboxSizeClass()),setTimeout(()=>{this.draggable(),this.resize()},250)},!0),!themifyBuilder.disableShortcuts){const t=t=>{const e=r.document.activeElement;'INPUT'===e.tagName||'TEXTAREA'===e.tagName||r.document.fullscreenElement||'true'===e.contentEditable||('Escape'===t.code&&_.activeModel?(t.preventDefault(),t.stopPropagation(),this.save().then(()=>{this.close()})):'KeyS'!==t.code||!0!==t.ctrlKey&&!0!==t.metaKey||(t.preventDefault(),t.stopPropagation(),(_.activeModel?this:_.Builder.get()).save()))};h.tfOn('keydown',t),'visual'===_.mode&&r.document.tfOn('keydown',t)}},open(d,e){return new Promise(c=>{const t=t=>{this.el.classList.add('tf_hide');const e=this.el.querySelector('#tb_lightbox_container'),i=this.el.tfClass('tb_lightbox_actions_wrap')[0],s=h.createElement('button');if('string'==typeof t)e.innerHTML=t;else{for(;null!==e.firstChild;)e.lastChild.remove();e.appendChild(t)}for(;null!==i.firstChild;)i.lastChild.remove();if(!1!==d.save){if(s.className='builder_button builder_save_button',s.title=themifyBuilder.i18n.label.ctr_save,s.textContent=themifyBuilder.i18n.label.done,_.activeModel){_.isDocked&&this.el.classList.add('tb_lightbox_small'),'visual'===_.mode&&(null!==_.GS.activeGS?(_.liveStylingInstance=_.createStyleInstance(),_.liveStylingInstance.init(null,!0)):(_.liveStylingInstance||(_.liveStylingInstance=_.createStyleInstance()),_.liveStylingInstance.init()));const l=t=>{t.stopImmediatePropagation(),this.save().then(()=>{!0!==_.isGSPage&&(s.tfOff(t.type,l,{passive:!0}),n.tfOff(t.type,l,{passive:!0}))}).catch(t=>{console.log(t)})},n=h.createElement('a'),o=h.createElement('li'),a=h.createElement('span');o.className='tb_top_save_btn',n.className='tb_tooltip',n.href='javascript:;',a.textContent=themifyBuilder.i18n.label.done,n.append(_.Helper.getIcon('ti-check'),a),o.appendChild(n),this.el.tfClass('tb_options_tab')[0].appendChild(o),s.tfOn(b.click,l,{passive:!0}),n.tfOn(b.click,l,{passive:!0}),_.undoManager.start('saveLightbox',_.activeModel)}i.appendChild(s)}if('html'===d.loadMethod&&!0!==d.contructor){const r=e.tfClass('tb_tab_nav');for(let t=r.length-1;-1<t;--t){let e=r[t].tfTag('a');for(let t=e.length-1;-1<t;--t)e[t].tfOn(b.click,ThemifyConstructor.switchTabs)}}this.el.classList.remove('tf_hide'),e.style.scrollBehavior='auto',e.scrollTop=0,e.style.scrollBehavior='',this.responsiveTabs(),b.trigger('tb_opened_lightbox'),_.Spinner.showLoader('spinhide'),_.SmallPanel.hide(),c(this.el)};this.close(),e&&(_.activeModel=e);try{'html'===d.loadMethod?!0===d.contructor?t(ThemifyConstructor.run(d.data)):t(d.data):t(ThemifyConstructor.run(_.FormTemplates.getItem(d)))}catch(t){console.log(t)}})},close(){return this.el.classList.contains('tf_hide')||!0===_.isGSPage||(b.trigger('themify_builder_lightbox_before_close',this.el),this.el.classList.add('tf_hide'),this.cleanLightBoxContent(),_.undoManager.updateUndoBtns(),_.Utils.removeViewPortClass(this.el),b.trigger('themify_builder_lightbox_close',this.el),'visual'===_.mode&&r.Themify.trigger('themify_builder_lightbox_close',this.el),null!==_.activeModel&&('visual'===_.mode&&_.liveStylingInstance.clear(),!0===_.activeModel.is_new?_.activeModel.destroy(!0):!_.activeModel.is_Saved&&_.undoManager.has('saveLightbox')&&_.activeModel.restore(),_.activeModel.is_Saved||_.undoManager.clear('saveLightbox'),_.activeModel=null)),this},setStandAlone(o,a){return b.on('tb_opened_lightbox',()=>{this.isStandalone=!0,r.document.body.classList.add('tb_standalone_lightbox'),this.el.style.width=this.el.style.height='';const t=_.ToolBar.el.getBoundingClientRect(),e=getComputedStyle(this.el),i=parseInt(e.width),s=parseInt(e.height),l=r.innerWidth-10,n=r.innerHeight+10;a<t.bottom?a=t.bottom:n<a+s&&(a-=a+s-n),o<0?o=0:l<o+i&&(o-=o+i-l),this.el.style.transform='translate('+o+'px,'+a+'px)',this.el.style.width=i+'px',this.el.style.height=s+'px',this.setupLightboxSizeClass(i),b.on('themify_builder_lightbox_close',t=>{r.document.body.classList.remove('tb_standalone_lightbox'),t.style.transform=t.style.width=t.style.height='',this.isStandalone=!1,this.updateStorage(),this.setupLightboxSizeClass(this.getStorage().w)},!0)},!0),this},cleanLightBoxContent(){const e=this.el.querySelectorAll('#tb_lightbox_container,.tb_options_tab,.tb_lightbox_actions_wrap,.tb_action_breadcrumb');for(let t=e.length-1;-1<t;--t)for(;null!==e[t].firstChild;)e[t].lastChild.remove();return this},async save(){const i=_.activeModel;if(!this.el.classList.contains('tf_hide')){if(null!==i){if(!0!==_.isGSPage&&!_.Forms.isValidate(this.el.querySelector('#tb_options_setting')))throw'invalid';ThemifyConstructor.setStylingValues(_.activeBreakPoint);let t=i.get('mod_settings'),e=_.Helper.cloneObject(ThemifyConstructor.values);const s=_.Forms.serialize('tb_options_setting',!0);for(let t in s)e[t]=s[t];if('column'!==i.type){const n=_.Forms.serialize('tb_options_animation',!0),o=_.Forms.serialize('tb_options_visibility',!0);for(let t in n)e[t]=n[t];for(let t in o)e[t]=o[t];if('visual'===_.mode){const a='hide_all'===o.visibility_all||'hide'===o.visibility_desktop||'hide'===o.visibility_tablet||'hide'===o.visibility_tablet_landscape||'hide'===o.visibility_mobile;i.el.classList.toggle('tb_visibility_hidden',a)}'module'===i.type&&_.Builder.get().removeLayoutButton()}_.ActionBar.id===i.id&&_.ActionBar.clear(),e=_.Helper.clear(e,!1),t=_.Helper.clear(t,!1);const l=_.Helper.compareObject(t,e);!0===l&&(b.trigger('themify_builder_save_component',[e,t]),'visual'===_.mode&&r.Themify.trigger('themify_builder_save_component',[e,t]),i.set('mod_settings',e)),i.is_new=!1,i.is_Saved=!0,this.close(),!0!==_.isGSPage&&!0===l?_.undoManager.end('saveLightbox'):_.undoManager.clear('saveLightbox'),delete i.is_new,delete i.is_Saved}else r.document.body.classList.contains('tb_standalone_lightbox')&&await b.trigger('tb_save_lb');!0===_.isGSPage&&await TF_Notification.showHide('done',themifyBuilder.globalStyleData.save_text,2e3)}},resize(){const u=this,e=this.el.tfClass('tb_resizable');for(let t=e.length-1;-1<t;--t)e[t].tfOn('pointerdown',function(t){if(1===t.which){t.stopImmediatePropagation();let e=this.ownerDocument,o=u.el,i;o.style.willChange='transform,width,height';const a=350,r=880,c=.9*e.documentElement.clientHeight,d=parseInt(getComputedStyle(o).getPropertyValue('min-height')),h=this.dataset.axis,f=parseInt(o.offsetHeight,10),g=parseInt(o.offsetWidth,10),p=t.clientX,_=t.clientY,s=n=>{n.stopImmediatePropagation(),i=requestAnimationFrame(()=>{let t;const e=n.clientX,i=n.clientY,s=new DOMMatrix(getComputedStyle(o).transform);if('w'===h)(t=(t=p+g-e)>r?r:t)>=a&&t<=r&&(s.m41+=parseInt(o.style.width)-t,o.style.width=t+'px',u.setupLightboxSizeClass(t));else{const l='-y'===h||'ne'===h||'nw'===h?_+f-i:f+i-_;(t='sw'===h||'nw'===h?p+g-e:g+e-p)>r&&(t=r),('se'===h||'x'===h||'sw'===h||'nw'===h||'ne'===h)&&t>=a&&t<=r&&('sw'!==h&&'nw'!==h||(s.m41+=parseInt(o.style.width)-t),o.style.width=t+'px',u.setupLightboxSizeClass(t)),('se'===h||'y'===h||'-y'===h||'sw'===h||'nw'===h||'ne'===h)&&l>=d&&l<=c&&('-y'!==h&&'nw'!==h&&'ne'!==h||(s.m42+=parseInt(o.style.height)-l),o.style.height=l+'px')}o.style.transform='translate('+s.m41+'px,'+s.m42+'px)',b.trigger('tb_resize_lightbox')})},l=function(t){t.stopImmediatePropagation(),i&&cancelAnimationFrame(i),this.tfOff('pointermove',s,{passive:!0}),o.style.willChange='',u.updateStorage(),e.body.classList.remove('tb_start_animate'),e=o=i=null};this.tfOn('pointermove',s,{passive:!0}).tfOn('lostpointercapture',l,{passive:!0,once:!0}).setPointerCapture(t.pointerId),e.body.classList.add('tb_start_animate')}},{passive:!0})},draggable(){const f=this,e=this.el.querySelectorAll('.tb_lightbox_top_bar,.tb_action_breadcrumb');for(let t=e.length-1;-1<t;--t)e[t].tfOn('pointerdown',function(t){if(1===t.which){const e=t.target.classList;if(e.contains('tb_lightbox_top_bar')||e.contains('tb_action_breadcrumb')){t.stopImmediatePropagation();let e,n=f.el,i=this.ownerDocument;n.style.willChange='transform';const s=t.clientX,l=t.clientY,o=n.getBoundingClientRect(),a=o.left-s,r=o.top-l,c=o.width,d=l=>{l.stopImmediatePropagation(),e=requestAnimationFrame(()=>{const t=l.clientX,e=l.clientY,i=a+t,s=r+e;n.style.transform='translate('+i+'px,'+s+'px)',b.trigger('tb_panel_drag',[i,c])})},h=t=>{t.stopImmediatePropagation(),b.trigger('tb_panel_drag_start'),!1===this.isStandalone&&this.setupLightboxSizeClass()};i.body.classList.add('tb_start_animate','tb_drag_lightbox'),_.ToolBar.el.classList.add('tb_start_animate','tb_drag_lightbox'),_.MainPanel.el.classList.add('tb_start_animate','tb_drag_lightbox'),this.tfOn('lostpointercapture',function(t){t.stopImmediatePropagation(),e&&cancelAnimationFrame(e),this.tfOff('pointermove',h,{passive:!0,once:!0}).tfOff('pointermove',d,{passive:!0}),n.style.willChange='',b.trigger('tb_panel_drag_end'),!1===f.isStandalone&&(f.updateStorage(),f.setupLightboxSizeClass()),i.body.classList.remove('tb_start_animate','tb_drag_lightbox'),_.ToolBar.el.classList.remove('tb_start_animate','tb_drag_lightbox'),_.MainPanel.el.classList.remove('tb_start_animate','tb_drag_lightbox'),e=n=i=null},{passive:!0,once:!0}).tfOn('pointermove',h,{passive:!0,once:!0}).tfOn('pointermove',d,{passive:!0}).setPointerCapture(t.pointerId)}}},{passive:!0})},responsiveTabs(){let t,s=null,l=0,n=null,e=()=>{const t=()=>{if(null===s&&null!==(s=this.el.querySelector('.tb_styling_tab_nav ul'))){const t=s.lastElementChild;l=t.offsetLeft+t.offsetWidth}if(null!==s&&0!==l){_.isDocked?s.style.display='none':s.style.flexDirection='row';const e=s.parentNode.offsetWidth;if(e<=l||_.isDocked){s.style.display='none';const i=s.tfClass('current')[0];null===n&&((n=h.createElement('span')).className='tb_ui_dropdown_label',n.tabIndex='-1',s.before(n)),i&&(n.textContent=i.textContent),setTimeout(()=>{s.style.display=''},100)}else null!==n&&(n.remove(),n=null);return!(s.style.flexDirection='')}if(_.isDocked)return!1};_.isDocked&&t()||setTimeout(t,0)};e(),b.on('tb_builder_tabsactive',e).on('tb_resize_lightbox',e).on('themify_builder_lightbox_close',()=>{b.off('tb_builder_tabsactive',e).off('tb_resize_lightbox',e),t=s=l=n=e=null},!0)},setupLightboxSizeClass(t){t=t||(_.isDocked?parseInt(getComputedStyle(this.el).width):this.getStorage().width||parseInt(this.el.offsetWidth));const e=this.el.classList;e.toggle('larger-lightbox',750<t),e.toggle('tb_lightbox_small',t<540)},getStorage(){if(null===this.size){let t=localStorage.getItem(this.storageKey);t=t?JSON.parse(t):{};const e={top:100,left:Math.max(0,r.innerWidth/2-300),width:600,height:500};this.size=Object.assign(e,t)}return this.size},updateStorage(){if(!1===this.isStandalone){const e=this.el.style.transform,i=e?new DOMMatrix(e):null,s=this.el.tfClass('tb_lightbox_top_bar')[0].getBoundingClientRect(),l=r.innerHeight-s.height,n=r.innerWidth,o=this.getStorage();let t={width:this.el.style.width,height:this.el.style.height};return i&&(t.top=i.m42,t.left=i.m41),t.height<=0?delete t.height:t.height=parseInt(t.height),t.width<=0?delete t.width:t.width=parseInt(t.width),((t=Object.assign({},o,t)).left<0||t.left+s.width>n)&&(t.left=t.left<0?0:n-s.width),(t.top<0||t.top>l)&&(t.top=t.top<0?0:l),this.el.style.transform='translate('+t.left+'px,'+t.top+'px)',this.el.style.width=t.width+'px',this.el.style.height=t.height+'px',_.isDocked||o===t||Object.entries(t).toString()===Object.entries(o).toString()||(this.size=null,localStorage.setItem(this.storageKey,JSON.stringify(t))),t}}},_.LiteLightBox={el:null,open(t){const e=h.createElement('form'),i=h.createElement('span');if(!this.el){const s=h.tfId('tb_lite_lightbox_root'),l=s.firstElementChild,n=_.ToolBar.el.getRootNode(),o=n.querySelector('#tf_base');l&&(s.attachShadow({mode:l.getAttribute('shadowroot')}).appendChild(l.content),l.remove()),s.shadowRoot.prepend(o.cloneNode(!0)),this.el=s.shadowRoot.tfId('wrapper'),r.document.body.appendChild(s),this.el.tfOn(b.click,t=>{this.el===t.target&&this.close(t)})}e.className='content tf_abs_c tf_textc tf_box',i.tfOn(b.click,t=>{this.close(t)},{once:!0}).className='tf_close',e.append(t,i),this.el.appendChild(e),this.el.getRootNode().host.classList.remove('tf_hide')},close(t){this.el&&(t&&(t.stopPropagation(),t.preventDefault()),_.Registry.trigger(this.el,'close'))},create(l){const e=h.createDocumentFragment();for(let s in l)if('buttons'===s){let i=h.createElement('div');i.className='btns';for(let e in l[s]){let t=h.createElement('button');t.className='tf_inline_b tf_textc',t.dataset.type=e,t.tfOn(b.click,t=>{this.buttonClick(t)}).innerText=l[s][e],i.appendChild(t)}e.appendChild(i)}else if('msg'===s){let t=h.createElement('div');t.className='msg',t.innerHTML=l[s],e.appendChild(t)}else if('input'===s){let t=h.createElement('input');t.className=l[s].class+' tf_w',t.value=l[s].value||'',t.tfOn('keydown',t=>{this.keyPress(t)},{passive:!0}).type=l[s].type,setTimeout(()=>{t.focus()},100),e.appendChild(t)}return e},confirm(t){return t.buttons||(t.buttons={no:ThemifyConstructor.label.no,yes:ThemifyConstructor.label.y}),this.open(this.create(t)),new Promise(i=>{_.Registry.on(this.el,'confirm',t=>{let e=this.el.querySelector('.content').tfTag('input')[0];e?(e=e.value||'',i([t,e])):i(t)}).on(this.el,'close',()=>{i(null)})}).finally(()=>{_.Registry.off(this.el,'confirm').off(this.el,'close').remove(this.el),this.el.getRootNode().host.classList.add('tf_hide'),this.el.innerHTML=''})},alert(t){return this.confirm({msg:t,buttons:{yes:ThemifyConstructor.label.ok}})},prompt(t,e){return this.confirm({msg:t,input:{type:'text',class:'prompt_input',value:e},buttons:{no:ThemifyConstructor.label.cancel,yes:ThemifyConstructor.label.ok}})},buttonClick(t){t.preventDefault(),t.stopPropagation();const e=t.currentTarget.dataset.type;'cancel'===e?this.close():_.Registry.trigger(this.el,'confirm',e)},keyPress(t){'Enter'===t.code&&_.Registry.trigger(this.el,'confirm','yes',t.currentTarget.value.trim())}},_.Forms={validators:new Map,parseSettings(s,t){const e=s.classList,i=t?s.dataset.inputId:s.id;if(!i)return!1;if(!e.contains('tb_row_js_wrapper')){let t=s.closest('.tb_field');if(null!==t&&!t.classList.contains('_tb_hide_binding')&&('none'!==t.style.display||-1===t.className.indexOf('tb_group_element_'))&&(t=t.parentNode).classList.contains('tb_multi_fields')&&t.parentNode.classList.contains('_tb_hide_binding'))return!1}let n='';if(e.contains('tb_lb_wp_editor'))if('undefined'!=typeof tinyMCE){const l=s.id,o=tinyMCE.get(l);n=null!==o?!1===o.hidden?o.getContent():switchEditors.wpautop(tinymce.DOM.get(l).value):s.value}else n=s.value;else if(e.contains('tb_checkbox_wrap')){const a=[],r=s.tfClass('tb_checkbox'),c=e.contains('tb_switcher');for(let t=0,e=r.length;t<e;++t)!0!==c&&!0!==r[t].checked||''===r[t].value||a.push(r[t].value);n=0<a.length?a.join('|'):!!c&&''}else if(e.contains('themify-layout-icon'))n=(n=s.tfClass('selected')[0])!==u?n.id:'';else if(e.contains('tb_search_input')){n=s.dataset.value;let t=s.closest('.tb_input'),e=t.tfClass('query_category_multiple')[0];e&&(''!==(e=e===u?'':e.value.trim())?n=e+'|'+(-1!==e.indexOf(',')?'multiple':'single'):n+='|single')}else if(e.contains('tb_radio_wrap')){const d=s.tfTag('input');let e=null;for(let t=d.length-1;-1<t;--t)if(!0===d[t].checked){e=d[t];break}null===e||'desktop'!==_.activeBreakPoint&&e.classList.contains('tb_responsive_disable')||(n=e.value)}else if(e.contains('tb_search_container'))n=s.previousElementSibling.dataset.value;else if(e.contains('tb_row_js_wrapper')){n=[];const h=s.tfClass('tb_repeatable_field_content');for(let s=0,t=h.length;s<t;++s){let i=h[s].tfClass('tb_lb_option_child');n[s]={};for(let e=0,t=i.length;e<t;++e){let t=this.parseSettings(i[e],!0);t&&t.id&&(n[s][t.id]=t.v)}}}else if(e.contains('module-widget-form-container'))n=this.themifySerializeObject(s);else if(e.contains('tb_widget_select'))n=(n=s.tfClass('selected')[0])!==u?n.dataset.value:'';else if(e.contains('tb_sort_fields_parent')){const f=s.children;n=[];for(let i=0,t=f.length;i<t;++i){let e=f[i].dataset.type;if(e){let t=f[i].tfClass('tb_sort_field_dropdown')[0],s={type:e,id:f[i].dataset.id};if(t!==u){s.val={};let i=t.tfClass('tb_lb_sort_child');for(let e=i.length-1;-1<e;--e){let t=this.parseSettings(i[e],!0);t&&t.id&&(s.val[t.id]=t.v)}}else{let t=f[i].tfTag('input')[0],e=t.value;''!==e&&(s.val=JSON.parse(e))}n.push(s)}}0===n.length&&(n='')}else if(e.contains('tb_accordion_fields')){const g=s.children;n={};for(let l=0,t=g.length;l<t;++l){let s=g[l].dataset.id;if(s){let e=g[l].tfTag('input')[0],t=g[l].tfClass('tb_accordion_fields_options')[0],i={};if(t!==u)i.val=this.serialize(t,null,!0);else{let t=e.value;''!==t&&(i.val=JSON.parse(t))}n[s]=i}}}else if(e.contains('tb_toggleable_fields')){const p=s.children;n={};for(let l=0,t=p.length;l<t;++l){let s=p[l].dataset.id;if(s){let e=p[l].tfTag('input')[0],t=p[l].tfClass('tb_toggleable_fields_options')[0],i={on:p[l].tfClass('tb_switcher')[0].tfClass('toggle_switch')[0].value};if(t!==u)i.val=this.serialize(t,null,!0);else{let t=e.value;''!==t&&(i.val=JSON.parse(t))}n[s]=i}}}else if('SELECT'===s.nodeName&&s.multiple){n=[];for(let t=s.selectedOptions,e=0,i=t.length;e<i;++e)n.push(s.selectedOptions[e].value)}else if(n=s.value,window.tbpDynamic!==u&&i===tbpDynamic.field_name){if(''===n)return!1;'string'==typeof n&&(n=JSON.parse(n))}else{if(i===_.GS.key&&'desktop'!==_.activeBreakPoint)return!1;if(''!==n)if('builder_content'===i)'string'==typeof n&&(n=JSON.parse(n));else{if('string'==typeof n&&-1!==n.indexOf(':')&&-1!==n.indexOf('{'))try{let t=JSON.parse(n);n=t}catch(t){}let t=s.dataset.opacity;null!==t&&''!==t&&(t=parseFloat(parseFloat(Number(t).toFixed(2)).toString()))<.99&&(n+='_'+t)}}return{id:i,v:n=n!==u&&null!==n?n:''}},serialize(t,i,s){const l={},e='object'==typeof t?t:_.LightBox.el.querySelector('#'+t);if(s=s||!1,null!==e){const n=e.tfClass(s?'tb_lb_option_child':'tb_lb_option');for(let e=n.length-1;-1<e;--e){let t=this.parseSettings(n[e],s);!1===t||!t.id||!0!==i&&''===t.v||(l[t.id]=t.v)}}return l},initValidators(){this.registerValidator('email',t=>{const e='string'==typeof t?t:t.value.split(','),i=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;for(let t=e.length-1;-1<t;--t)if(!i.test(e[t]))return!1;return!0}),this.registerValidator('custom_css_id',t=>{let e=0,i=t.value.trim();if(i){for(i=i.replace(/[^a-zA-Z0-9\-\_]/g,'');!isNaN(i[0]);)i=i.substring(1);if(i){const s=h.querySelectorAll('#'+i);if(1<s.length)for(let t=s.length-1;-1<t;--t)null!==s[t].closest('.module_row')&&++e}}return t.value=i,e<=1}),this.registerValidator('custom_css',t=>{let e=t.value;if(e){for(let t=(e=e.replace(/\s\s+/g,' ').split(' ')).length-1;-1<t;--t)if(e[t]=e[t].replace(/[^a-zA-Z0-9\s\-\_]/g,''),''!==e[t][0])for(;!isNaN(e[t][0]);)e[t]=e[t].substring(1);e=e.join(' ')}return t.value=e,!0}),this.registerValidator('not_empty',t=>''!==t.value.toString().trim())},registerValidator(t,e){this.validators.set(t,e)},getValidator(t){return this.validators.get(t)||this.validators.get('not_empty')},isValidate(t){const n=t.tfClass('tb_must_validate'),e=n.length,o=(_.LightBox.el.tfClass('builder_save_button')[0],(t,e)=>{const i=this.getValidator(t);return i(e)});if(0===e)return!0;let a=!0;for(let l=e-1;-1<l;--l){let i=n[l].tfClass('tb_lb_option')[0],s=o(n[l].dataset.validation,i);if(!0!==s){if(!i.classList.contains('tb_field_error')){let t=h.createElement('span'),e='SELECT'===i.tagName?i.parentNode:i;t.className='tb_field_error_msg',t.textContent=!1===s?n[l].dataset.errorMsg:s,i.classList.add('tb_field_error'),e.parentNode.insertBefore(t,e.nextSibling)}a=!1}else{i.classList.remove('tb_field_error');let e=n[l].tfClass('tb_field_error_msg');for(let t=e.length-1;-1<t;--t)e[t].remove()}}if(!1===a){const i=_.LightBox.el.querySelector('a[data-id="'+t.id+'"]');i.parentNode.classList.contains('current')||b.triggerEvent(i,b.click),TF_Notification.showHide('error',themifyBuilder.i18n.lightBoxRequiredFields)}return a},themifySerializeObject(t){const n={},o=t.querySelectorAll('input,select,textarea');for(let l=o.length-1;-1<l;--l){let t=o[l].tagName,e=o[l].type,i=o[l].value,s=o[l].name||o[l].id;if(s&&'button'!==e&&'submit'!==e&&''!==i){if(o[l].classList.contains('wp-editor-area')&&'undefined'!=typeof tinyMCE){let t=tinyMCE.get(o[l].id);t&&(i=t.getContent().trim())}else if('radio'===e||'checkbox'===e||'select'===t)if('select'===t){if(o[l].hasAttribute('multiple')){let s=[];for(let t=0,e=o[l].children,i=e.length;t<i;++t)e[t].selected&&s.push(e[t].value);i=s}}else if(!o[l].checked)continue;''!==i&&('checkbox'===e?(n[s]===u&&(n[s]=[]),n[s].push(i)):n[s]=i)}}return n}},_.LightBox.init()})(tb_app,Themify,window.top,document,void 0);