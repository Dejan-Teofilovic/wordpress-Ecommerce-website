let ThemifyBuilderPage;((_,v,w)=>{'use strict';const m=new IntersectionObserver((i,r)=>{for(let n=i.length-1;-1<n;--n)if(!0===i[n].isIntersecting){r.unobserve(i[n].target);let e=i[n].target,t=new Image(300,348),s=v.createElement('div'),l=e.tfTag('img')[0],a=l.dataset.src;s.className='tf_loader tf_abs_c',t.decoding='async',t.src=a,t.title=t.alt=l.alt,e.appendChild(s),t.decode().catch(()=>{}).finally(()=>{l.replaceWith(t),s.remove()})}},{threshold:.1});ThemifyBuilderPage={el:null,layoutsList(){return _.fetch('',null,{credentials:'omit',method:'GET',mode:'cors',headers:{'Content-Type':'application/json'}},w.paths.predesigned.url)},publish(e){return e.set('nonce',w.nonce),e.set('action','tb_builder_page_publish'),_.fetch(e).then(e=>{if(!e.success)throw e.error;window.location=e.data})},getIcon(e){const t='http://www.w3.org/2000/svg',s=v.createElementNS(t,'use'),l=v.createElementNS(t,'svg');return e='tf-'+e.trim().replace(' ','-'),l.setAttribute('class','tf_fa '+e),s.setAttributeNS(null,'href','#'+e),l.appendChild(s),l},renderLayouts(n){const e=-1!==v.createElement('canvas').toDataURL('image/webp').indexOf('data:image/webp'),i=e?'webp':'png',r="//via.placeholder.com/300x348."+i+'?text=',o=new Set,c=w.i18n.preview,d=this.getIcon('ti-search'),h=v.createDocumentFragment(),p=v.createDocumentFragment(),t=v.createElement('li');t.textContent=w.i18n.all,p.appendChild(t),n.unshift({slug:'blank',title:w.i18n.blank});for(let a=0,e=n.length;a<e;++a){let e=v.createElement('li'),t=v.createElement('div'),s=v.createElement('div'),l=new Image(300,348);if(n[a].category&&(e.dataset.category=n[a].category),e.dataset.slug=n[a].slug,t.className='thumb tf_rel',l.loading='lazy',l.decoding='async',l.src='blank'===n[a].slug?_.builder_url+'img/blank-layout.'+i:r+encodeURI(n[a].title),l.alt=l.title=n[a].title,n[a].thumbnail&&(l.dataset.src=n[a].thumbnail,m.observe(t)),s.className='title',s.textContent=n[a].title,void 0!==n[a].url){let e=v.createElement('a');e.className='link tf_box',e.href=n[a].url,e.target='_blank',e.title=c,e.appendChild(d.cloneNode(!0)),t.appendChild(e)}if(t.appendChild(l),e.append(t,s),h.appendChild(e),n[a].category){let s=n[a].category.toString().split(',');for(let t=0,e=s.length;t<e;++t)if(''!==s[t]&&!o.has(s[t])){let e=v.createElement('li');e.textContent=s[t],p.appendChild(e),o.add(s[t])}}}return{items:h,cats:p}},dropDown(){return _.fetch({action:'tb_builder_page_dropdown',nonce:w.nonce},'html')},render(e,t){const s=v.createElement('form'),l=v.createElement('div'),a=v.createElement('button'),n=v.createElement('button'),i=v.createElement('span'),r=v.createElement('div'),o=v.createElement('input'),c=v.createElement('div'),d=v.createElement('div'),h=v.createElement('div'),p=v.createElement('button'),m=v.createElement('ul'),f=v.createElement('input'),u=v.createElement('div'),g=v.createElement('ul'),y=this.renderLayouts(e),b=_.click;s.method='POST',s.className='tf_h',l.className='top',u.className='wrapper tf_scrollbar tf_overflow tf_box',a.type='submit',p.type=n.type='button',a.className='submit',n.className='tf_close',f.type=o.type='text',r.className='header',o.className='post_title',o.name='post_title',o.required=!0,c.className='parent',d.className='sticky',h.className='category tf_rel',p.className='filter_label tf_rel',m.className='filter tf_scrollbar tf_abs_t tf_overflow tf_opacity tf_box',f.className='search',g.className='content',i.textContent=w.i18n.cancel,a.textContent=w.i18n.publish,p.textContent=w.i18n.all,o.placeholder=w.i18n.title,f.placeholder=w.i18n.search,n.appendChild(i),s.tfOn('submit',e=>{e.preventDefault(),this.submit(e.currentTarget)}),f.tfOn('input',e=>{this.filter(m.firstElementChild),this.search(e.currentTarget.value)},{passive:!0}),m.tfOn(b,e=>{'LI'===e.target.tagName&&(this.clearSearch(e.target),this.filter(e.target))},{passive:!0}),n.tfOn(b,e=>{this.close()},{passive:!0}),g.tfOn(b,e=>{const t=e.target.closest('li');t&&this.select(t)},{passive:!0}),l.append(n,a),c.appendChild(t),r.append(o,c),m.appendChild(y.cats),h.append(p,m),d.append(h,f),g.appendChild(y.items),u.append(r,d,g),s.append(l,u),this.el.classList.add('tf_abs_c','tf_overflow','tf_box'),this.el.appendChild(s),setTimeout(()=>{o.focus()},30)},submit(e){const a=new FormData(e),t=a.get('post_title');if(a.get('parent'),t){let l=this.el.tfClass('selected')[0];if(l=l&&l.dataset.slug,this.showLoader(),l&&'blank'!==l){const s=w.paths.predesigned.single.replace('{SLUG}',l);_.fetch('',null,{credentials:'omit',method:'GET',mode:'cors',headers:{'Content-Type':'application/json'}},s).then(e=>{const t={builder_data:e},s=e=>{a.set('layout',JSON.stringify(e)),this.publish(a).finally(()=>{this.showLoader('hide'),this.close()})};-1!==JSON.stringify(e).indexOf('global_styles')?_.fetch('',null,{credentials:'omit',method:'GET',mode:'cors',headers:{'Content-Type':'application/json'}},w.paths.predesigned.single.replace('{SLUG}',l+'-gs')).then(e=>{t.used_gs=e}).finally(()=>{s(t)}):s(t)}).catch(()=>{this.showLoader('hide'),alert(w.i18n.layout_error.replace('{FILE}',s))})}else this.publish(a).finally(()=>{this.showLoader('hide'),this.close()})}},showLoader(e='show'){this.el.getRootNode().querySelector('.spinner').style.display='show'===e?'':'none'},show(){this.el.style.setProperty('transform','translate(-50%, 100%)'),this.el.style.display='',setTimeout(()=>{this.el.style.setProperty('transform','')},20)},close(){this.el.tfOn('transitionend',function(){this.style.display='none'},{passive:!0,once:!0}).style.setProperty('transform','translate(-50%, 100%)')},filter(t){if(!t.classList.contains('current')){const l=this.el.tfClass('content')[0].children,e=t.classList.contains('all'),s=t.parentNode,a=t.textContent,n=s.children;for(let s=l.length-1;-1<s;--s){let t=e;if(!t){let e=l[s].getAttribute('data-category');e&&(t=a===e||-1!==e.indexOf(a))}l[s].style.display=t?'':'none'}for(let e=n.length-1;-1<e;--e)n[e].classList.toggle('current',n[e]===t);s.parentNode.tfClass('filter_label')[0].textContent=a}},search(t){t=t.trim().toUpperCase();const s=this.el.tfClass('title');for(let e=s.length-1;-1<e;--e)s[e].parentNode.style.display=''===t||0===s[e].textContent.toUpperCase().indexOf(t)?'':'none'},clearSearch(){const e=this.el.tfClass('search')[0];e.value='',_.triggerEvent(e,'input')},select(e){const t=this.el.tfClass('selected')[0];t&&t.classList.remove('selected'),e.classList.add('selected')},run(e){return this.el?this.el.style.display?(this.show(),Promise.resolve()):void 0:(this.el=e,Promise.all([this.layoutsList(),this.dropDown(),_.fonts('ti-search')]).then(e=>{const t=this.el.getRootNode();t.prepend(t.host.ownerDocument.getElementById('tf_svg').cloneNode(!0)),this.render(e[0],e[1]),this.showLoader('hide'),this.show()}))}}})(Themify,document,tbBuilderPage);