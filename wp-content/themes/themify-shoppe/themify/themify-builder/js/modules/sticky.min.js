((s,f)=>{'use strict';let i,o=!1,d=s.w,b=s.h,t=!1;const h=new Map,e='m'===tbLocalScript.is_sticky&&parseInt(tbLocalScript.breakpoints.tablet[1]),l=e=>{!0!==o&&requestAnimationFrame(()=>{const s=f.pageYOffset,t=e||h;for(let e of t){let o=e[0],l=e[1],t=o.classList.contains('tb_sticky_scroll_active');if('disable'!==l)if(!0===l.isBottom&&s+b>=l.space||!0!==l.isBottom&&s>l.space){if(!1===t&&(o.parentNode.style.height=l.h+'px',o.style.position='fixed',o.style.top=l.value,o.style.width=l.w+'px',o.classList.add('tb_sticky_scroll_active')),l.unstick&&l.unstick.item){let t=l.unstick,e=parseInt(l.value),s=t.item.getBoundingClientRect(),i;'builder'===t.type?i=s.bottom-l.h-e:(i='passes'===t.r?s.bottom-e:s.top-l.h-e,'top'!==t.cur&&'bottom'!==t.cur||(i+=t.v,'bottom'===t.cur&&(i-=b))),i=i<0?i+e+'px':l.value,l.currentTop!==i&&(l.currentTop=i,h.set(o,l),o.style.top=i)}}else!0===t&&u(o)}})},u=t=>{const e=t.style;e.width=e.top=e.bottom=e.position=t.parentNode.style.height='',t.classList.remove('tb_sticky_scroll_active')},n=new MutationObserver(e=>{if(e[0]){let t=e[0].target.closest('[data-sticky-active]');t&&(i&&cancelAnimationFrame(i),i=requestAnimationFrame(()=>{s.imagesLoad(t).then(t=>{const e=new Map;u(t),a(t),e.set(t,h.get(t)),l(e),i=null})}))}}),a=(i,e,t)=>{const s=i.classList.contains('tb_sticky_scroll_active');if(!1===s||!0===t){if(!h.has(i)||!0===t){const l=(i=>{let o=!1;const l=tbLocalScript.breakpoints,n=Object.keys(l);for(let t=n.length-1;-1<t;--t){let e=n[t],s='tablet_landscape'===e?'tl':e[0];if(void 0!==i[s]){let t='mobile'!==e?l[e][1]:l[e];if(t>=d){o=i[s];break}}}return o=!1===o?i.d:o})(JSON.parse(i.getAttribute('data-sticky-active')));if(!l)return h.set(i,'disable'),void u(i);const n=l.stick||{},a=n.v?parseInt(n.v):0,c=l.unstick,r=n.u||'px';if('px'!==r?l.u=r:l.value=a+r,l.v=a,'bottom'===n.p&&(l.isBottom=!0),c){let e,s=i.closest('.themify_builder_content');if('builder'===c.type){let t=s.closest('#tbp_header');(t=t&&(null!==(t=document.tfId('tbp_content'))?t.tfClass('themify_builder_content')[0]:document.tfClass('themify_builder_content')[1]))&&(s=t),e=s}else(e=(e='row'===c.type?s.tfClass('tb_'+c.el)[0]:e)||s.tfClass('tb_'+c.el)[0])&&(c.v=parseInt(c.v));e&&(c.item=e)}if(!i.parentNode.classList.contains('tb_sticky_wrapper')){const p=document.createElement('div');p.className='tb_sticky_wrapper',i.before(p),p.appendChild(i)}h.set(i,l)}const o=h.get(i);if('disable'!==o){!0===s&&(i.style.position=''),e||(i.style.width='',e=i.getBoundingClientRect()),o.w=0<e.width?e.width:i.offsetWidth,o.h=0<e.height?e.height:i.offsetHeight;let t=o.v;'%'===o.u&&0!==t&&(t=t/100*b),!0===o.isBottom&&(t=b-t-o.h),o.value=t+'px',o.space=void 0!==o.isBottom?e.bottom+f.pageYOffset+t:e.top+f.pageYOffset-t,o.t=e.top,i.parentNode.style.height!==o.h+'px'&&(i.parentNode.style.height=o.h+'px'),!0===s&&(i.style.position='fixed'),h.set(i,o)}}},c=new IntersectionObserver((e,t)=>{for(let t=e.length-1;-1<t;--t)!0===e[t].isIntersecting&&a(e[t].target,e[t].boundingClientRect)},{threshold:[.3,.4,.5,.6,.7,.8,.9,1]});s.on('tb_sticky_init',e=>{for(let t=e.length-1;-1<t;--t)c.observe(e[t]),n.observe(e[t],{subtree:!0,childList:!0});if(!1===t){if(t=!0,0<f.pageYOffset){for(let t=e.length-1;-1<t;--t)a(e[t],e[t].getBoundingClientRect());l()}f.tfOn('scroll',t=>{l()},{passive:!0})}}).on('tfsmartresize',t=>{if(t){d=t.w,b=t.h,o=!!(e&&e>=d);for(let t of h)!0===o?u(t[0]):a(t[0],null,!0);!1===o&&l()}})})(Themify,window);