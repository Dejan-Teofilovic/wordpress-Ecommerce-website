((x,S,w)=>{'use strict';let L=!1;const N=new IntersectionObserver((s,e)=>{for(var a=s.length-1;-1<a;--a){let e=s[a].target.id,t=S.querySelectorAll('.module-toc a[href="#'+CSS.escape(encodeURI(e))+'"]'),l=!0===s[a].isIntersecting;for(var o=t.length-1;-1<o;--o)t[o].parentNode.classList.toggle('tb_toc_active',l)}},{threshold:[0,1]}),l=t=>{if(tbLocalScript){const l=tbLocalScript.breakpoints;let e='desktop';return t<=l.mobile?e='mobile':t<=l.tablet[1]?e='tablet':t<=l.tablet_landscape[1]&&(e='tablet_landscape'),e}},A=e=>{let t=e.dataset.bp;return!(!t||'n'===t)&&(t='tl'===t?'tablet_landscape':'t'===t?'tablet':'mobile',t=tbLocalScript.breakpoints[t],(t=Array.isArray(t)?t[1]:t)>=x.w)},q=e=>{let t=e.target?e.target.closest('.tf_fa,a'):null;if(t)if('A'===t.tagName){const a=t.getAttribute('href').replace('#',''),o=S.querySelector('#'+CSS.escape(decodeURI(a))+'.tb_toc_el');o&&(e.preventDefault(),!1===x.is_builder_active&&requestAnimationFrame(()=>{x.lazyScroll(x.convert(x.selectWithParent('[data-lazy]',o.closest('.module_row'))).reverse(),!0).finally(()=>{const l=o.getBoundingClientRect(),s=window.scrollY;x.scrollTo(l.top+s-10,null,()=>{let e=S.tfId('headerwrap'),t=10;e&&e.classList.contains('fixed-header')&&(t+=e.getBoundingClientRect().bottom),x.scrollTo(l.top+s-t),window.location.hash=a})})}))}else if(t=t.closest('.tb_toc_head,.tb_toc_cic_close,.tb_toc_cic')){const l=t.parentNode,s=l.tfTag('ul')[0],i='0px'===getComputedStyle(s).getPropertyValue('max-height'),c=t.classList.contains('tb_toc_head')?'tb_tc_close':'tb_tc_sub_close',n=(s.style.maxHeight='none',s.clientHeight),r=i?n:0,d=i?0:n;s.style.maxHeight=d+'px',s.tfOn('transitionend',e=>{l.classList.toggle(c,!i),0<r&&(s.style.maxHeight=''),s.style.padding=0<r?'':'0px'},{passive:!0,once:!0}),requestAnimationFrame(()=>{s.style.maxHeight=r+'px',s.style.padding=0<r?'':'0px'})}};let a=l(x.w);x.on('builder_load_module_partial tb_toc',(e,t)=>{if(!0!==t||e.classList.contains('module-toc')){const l=x.selectWithParent('module-toc',e);for(let e=l.length-1;-1<e;--e)(c=>{let l=c.dataset.tags,a=c.dataset.excl,e=c.dataset.cont||'b',s=c.dataset.sel;if(l){let t;if('cust'===e){if(s){const h=(s=s.trim()).slice(-1);if(s=','!==h&&'.'!==h&&'#'!==h?s:s.slice(0,-1))try{t=S.querySelectorAll(s)}catch(e){}}}else{if('b'===e||'b_c'===e){if(t=c.closest('.themify_builder'),'b_c'===e){let e=t;for(;null!==(e=e.parentNode.closest('.themify_builder')););for(null===e&&(e=t.parentNode);null!==e&&null===e.nextElementSibling&&null===e.previousElementSibling;)e=e.parentNode;null!==e&&(t=e)}}else'r'===e||'c'===e?(t=c.closest('.module_column'),'r'===e&&(t=t.closest('.module_row'))):'doc'===e&&(t=S);t=t&&[t]}if(t&&0<t.length){l=l.replace(/\|/g,',');let e='#comments,.tf_carousel,.loops-wrapper,.module-accordion,.widget-title,.module-tab,.module-toc,.module-gallery,.module-image,.nav,.module-service-menu';c.dataset.ex_m&&(e+=',.module-title');const p=new Set,_=(c.classList.contains('tb_toc_tree'),[]),f=(S.createDocumentFragment(),c.tfClass('tpl_toc_ic')[0]),m=c.tfClass('tpl_toc_cic')[0],u=c.tfClass('tpl_toc_cic_close')[0],g=1<c.dataset.min?parseInt(c.dataset.min):2,b=parseInt(c.dataset.maxh)||32,v=parseInt(c.dataset.maxt)||0,y=(s,a)=>{const o=S.createDocumentFragment(),e=S.createElement('ul');e.className='tb_toc_lv_'+a+' tf_w tf_box',1===a&&A(c)&&(e.style.maxHeight='0',c.classList.add('tb_tc_close'));for(var i=0,t=s.length;i<t;++i){let e=S.createElement('li'),t=S.createElement('a'),l=S.createDocumentFragment();t.href='#'+s[i].id,t.textContent=s[i].text,f!==w&&l.appendChild(f.content.cloneNode(!0)),l.appendChild(t),0<s[i].childs.length&&(++a,m!==w&&l.appendChild(m.content.cloneNode(!0)),u!==w&&l.appendChild(u.content.cloneNode(!0)),l.appendChild(y(s[i].childs,a))),e.appendChild(l),o.appendChild(e)}return e.appendChild(o),e};if(a){const C=(a=a.trim()).slice(-1);','!==C&&'.'!==C&&'#'!==C||(a=a.slice(0,-1))}for(var o=0,i=t.length;o<i;++o){let s=t[o].querySelectorAll(l);for(var n=0,r=s.length;n<r;++n)if(!(p.has(s[n])||null!==s[n].closest(e)||a&&s[n].matches(a)&&s[n].closest(a))&&(p.add(s[n]),0<s[n].offsetWidth&&0<s[n].offsetHeight&&0<s[n].getClientRects().length)){let t=s[n].textContent.trim();if(t){0<v&&t.length>v&&(t=t.substr(0,v));let e=s[n].dataset.isSet?null:s[n].id,l=e||t.toLowerCase();if(l=l.replace(/(\r\n|\n|\r)/gm,' ').replace(/[`â€™~!@#$%^&*()|+\=?;:'",.<>\{\}\[\]\\\/]/gi,'').replace(/\s\s+/gu,' '),!e){if(!0===x.is_builder_active&&(s[n].dataset.isSet=!0),(l=l.replace(/\s/gu,'-')).length>b){if(1<(l=l.split('-')).length)for(var d=l.length-1;-1<d&&(l.splice(d,1),!(1===d||l.join('-').length<=b));--d);(l=l.join('-')).length>b&&(l=l.substring(0,b))}let e=2,t=l=!1===isNaN(l[0])?'tb-'+l:l;for(;null!==S.tfId(l);)l=t+'-'+e,++e}s[n].id=l,s[n].classList.add('tb_toc_el'),_.push({id:encodeURIComponent(l),text:t,h:+s[n].nodeName.replace('H',''),childs:[]}),!0!==x.is_builder_active&&N.observe(s[n])}}}if(p.clear(),_.length>g){if(c.classList.contains('tb_toc_tree')){for(o=1,i=_.length;o<i;++o)if(1!==_[o].h)if(_[o-1].h<_[o].h)_[o-1].childs.push(_[o]),_[o].delete=!0;else for(n=o-1;-1<n;--n)if(_[n].h<_[o].h){_[n].childs.push(_[o]),_[o].delete=!0;break}for(o=i-1;-1<o;--o)!0===_[o].delete&&_.splice(o,1)}requestAnimationFrame(()=>{const e=c.tfClass('tb_toc_lv_1')[0],t=(c.tfClass('tb_toc_head')[0],!1===L?window.location.hash:'');if(L=!0,e&&e.remove(),c.appendChild(y(_,1)),c.tfOn('click',q).classList.remove('tf_hide'),!1===x.is_builder_active&&''!==t&&'#'!==t){const l=c.querySelector('a[href="#'+t.replace('#','')+'"]');l&&l.click()}})}else requestAnimationFrame(()=>{c.classList.add('tf_hide')})}}})(l[e])}}).on('infiniteloaded',()=>{x.trigger('tb_toc')}).on('tfsmartresize',t=>{requestAnimationFrame(()=>{const e=l(t.w);if(e!==a){a=e;const s=S.tfClass('tb_toc_lv_1');for(let l=s.length-1;-1<l;--l){let e=s[l].parentNode,t=A(e);s[l].style.maxHeight=t?'0':'',e.classList.toggle('tb_tc_close',t)}}})})})(Themify,document,void 0);