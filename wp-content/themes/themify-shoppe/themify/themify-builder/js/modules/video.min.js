(l=>{'use strict';const n=ThemifyBuilderModuleJs.cssUrl+'video_styles/',s=(e,i)=>{const a=l.selectWithParent('module-video',e),o=e=>{const s=e.currentTarget,t=s.closest('.module-video').tfTag('video')[0];if(!s.tfClass('tb_video_buffer')[0]){const i=document.createElement('div'),a=function(e){let t=0<this.duration&&0<this.buffered.length?this.buffered.end(0)/this.duration*100:0;t<2&&(t=0),2<this.readyState&&(t=100,s.tfOff('pointerenter',o,{passive:!0}),this.tfOff('loadstart waiting progress canplay',a,{passive:!0}),i.tfOn('transitionend',e=>{requestAnimationFrame(()=>{this.closest('.tb_hover_play').classList.add('tb_video_loaded'),this.dataset.forceplay=1,l.video([this]),i.remove()})},{passive:!0,once:!0})),2<t&&(i.style.width=t+'%')};l.loadCss('video','tf_video'),l.loadJs('video-player'),i.className='tb_video_buffer tf_abs_t',s.tfTag('img')[0].after(i),t.tfOn('loadstart waiting progress canplay',a,{passive:!0})}t.load()};for(let t=a.length-1;-1<t;--t){let s=a[t],e=s.tfClass('tb_video_overlay')[0];if(s.classList.contains('video-overlay')&&l.loadCss(n+'overlay','tb_video_overlay'),s.classList.contains('tb_hover_play')){if(!l.is_builder_active){let e=s.tfTag('img')[0];e&&e.parentNode.tfOn('pointerenter',o,{passive:!0})}}else if(e)l.loadCss(n+'play_button','tb_video_play_button'),e.tfOn('click',d,{once:!0,passive:!0});else{let t=s.tfTag('noscript')[0];if(t){let e=document.createElement('template');e.innerHTML=t.textContent.trim()||t.innerHTML,t.replaceWith(e.content)}else if(i){let e=s.tfTag('video')[0];e.dataset.autoplay=1,l.video([e])}}s.classList.remove('tf_lazy')}},d=function(e){e.stopPropagation();const t=this.closest('.module-video');t.classList.add('tf_lazy'),this.remove(),s(t,1)};l.on('builder_load_module_partial',(e,t)=>{!0===t&&!e.classList.contains('module-video')||s(e)})})(Themify);