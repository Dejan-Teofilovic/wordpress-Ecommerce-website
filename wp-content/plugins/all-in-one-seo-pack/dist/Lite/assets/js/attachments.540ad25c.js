import{V as y}from"./_plugin-vue2_normalizer.d86aa1f3.js";import{s as n,i as g,b as v,d as f,e as S,f as C,g as k}from"./index.8eedf1b9.js";import{c as A,g as w}from"./cleanForSlug.d330f33d.js";import{f as H}from"./Caret.2b15c7cb.js";import{g as D,a as B}from"./html.bcbe747e.js";import{f as et}from"./helpers.a2b0759e.js";const nt=()=>!window.aioseo.currentPost||!window.aioseo.currentPost.id?!1:window.aioseo.options.advanced&&window.aioseo.options.advanced.truSeo&&!window.aioseo.currentPost.isSpecialPage&&window.aioseo.currentPost.postType!=="attachment"&&j(),qt=()=>!window.aioseo.screen||!window.aioseo.screen.postType?!1:!!(window.aioseo.options.advanced&&window.aioseo.options.advanced.truSeo&&j(window.aioseo.screen.postType)),j=(t=null)=>{if(t)return!!(window.aioseo.dynamicOptions.searchAppearance.postTypes[t]&&window.aioseo.dynamicOptions.searchAppearance.postTypes[t].advanced&&window.aioseo.dynamicOptions.searchAppearance.postTypes[t].advanced.showMetaBox);if(!window.aioseo.currentPost||!window.aioseo.currentPost.id)return!1;const e=window.aioseo.currentPost.postType,o=window.aioseo.currentPost.termType,a=!!(e&&window.aioseo.currentPost.context==="post"&&window.aioseo.dynamicOptions.searchAppearance.postTypes[e]&&window.aioseo.dynamicOptions.searchAppearance.postTypes[e].advanced&&window.aioseo.dynamicOptions.searchAppearance.postTypes[e].advanced.showMetaBox),s=!!(o&&window.aioseo.currentPost.context==="term"&&window.aioseo.dynamicOptions.searchAppearance.taxonomies[o]&&window.aioseo.dynamicOptions.searchAppearance.taxonomies[o].advanced&&window.aioseo.dynamicOptions.searchAppearance.taxonomies[o].advanced.showMetaBox);return a||s},T=async(t=900,e=!0)=>{H(async()=>{await ft(!1),await pt(!1),await vt(!1),await Pt(!1),await dt(!1),Tt(!1),xt(!1),St(!1),e&&y.prototype.$truSeo.runAnalysis({postId:n.state.currentPost.id})},t)},R=()=>{if(!window.aioseo.currentPost||!window.aioseo.currentPost.postType)return"";const t=window.aioseo.currentPost.postType,e=window.aioseo.dynamicOptions.searchAppearance.postTypes[t].customFields;if(!e||!nt)return"";const o=()=>{T(500)},a=e.replace(/\n/g,",").split(","),s=[],c=["INPUT","TEXTAREA","IMG"],r=i=>{try{document.createDocumentFragment().querySelector(i)}catch{return!1}return!0};a.forEach(i=>{i=i.trim();const l=r(`#${i}`)?document.querySelector(`#${i}`):!1,L=document.querySelectorAll("#the-list > tr"),Y=document.querySelectorAll(".acf-field");c.includes(l==null?void 0:l.tagName)&&!(l!=null&&l.closest(".acf-field"))?s.push(l):L.forEach(u=>{const m=u.querySelector(`#${u.id}-key`),P=u.querySelector(`#${u.id}-value`);c.includes(P==null?void 0:P.tagName)&&a.includes(m==null?void 0:m.value)&&s.push(P)}),Y.forEach(u=>{if(i!==u.dataset.name)return"";let m=u.querySelector(`[id^="acf"][name$="[${u.dataset.key}]"]`);if(u.dataset.type==="image"&&(m=u.querySelector(".has-value img")),u.dataset.type==="gallery"&&(m=u.querySelector(".acf-gallery-attachment img")),!m||m.type&&m.type==="hidden")return"";if(u.dataset.type==="wysiwyg"){const P=window.setInterval(()=>{var q,M;!((M=(q=window.tinyMCE)==null?void 0:q.activeEditor)!=null&&M.acf)||(window.clearInterval(P),window.tinyMCE.activeEditor.on("keyup",function(){T(500)}),window.tinyMCE.activeEditor.on("PostProcess",function(){H(()=>{T(500)},10)}))},50),K=function(q){q.forEach(M=>{var U;if(M.attributeName==="class"&&u.querySelector(".wp-editor-wrap.tmce-active")&&((U=window.tinyMCE)==null?void 0:U.activeEditor)){window.tinyMCE.activeEditor.on("keyup",function(){T(500)});const N=u.querySelector(`[name="acf[${u.dataset.key}]"]`);N&&(N.addEventListener("keyup",()=>{T(500)}),N.addEventListener("paste",()=>{T(500)}))}})},tt=new MutationObserver(K),O=u.querySelector(".wp-editor-wrap");O&&tt.observe(O,{attributes:!0})}c.includes(m.tagName)&&s.push(m)})});let d="";return s.forEach(i=>{let l="";if(c.includes(i.tagName)&&i.addEventListener("keyup",o),i.value&&(l=i.value),i.tagName==="IMG"&&i.src){const L=i.alt?`alt="${i.alt}"`:"";l=`<img src="${i.src}" ${L}>`}i.value&&i.type&&i.type==="url"&&(l=`<a href="${l}">${l}</a>`),l&&(d+=`${l} `)}),d},Mt=(t,e=["INPUT","TEXTAREA","IMG"])=>{if(!t)return"";const o=document.querySelector(`#${t}`),a=document.querySelectorAll("#the-list > tr"),s=document.querySelectorAll(".acf-field");let c="";return o&&e.indexOf(o.tagName)!==-1&&(o.closest(".acf-field")||(c=o.tagName==="IMG"?o.getAttribute("src"):o.value)),a.length&&a.forEach(r=>{const d=r.querySelector(`#${r.id}-key`),i=r.querySelector(`#${r.id}-value`);i&&e.indexOf(i.tagName)!==-1&&d.value===t&&(c=i.tagName==="IMG"?i.getAttribute("src"):i.value)}),s.length&&s.forEach(r=>{if(t!==r.dataset.name)return;let d;e.forEach(i=>{const l=i.toLowerCase();d=r.querySelector(`[data-key="${r.dataset.key}"] ${l}`)||d}),d&&(c=d.tagName==="IMG"?d.getAttribute("src"):d.value)}),c},ot=()=>{const t=window.elementor.documents.getCurrent(),e=[];return t.$element?(t.$element.find(".elementor-widget-container").each((o,a)=>{let s=a.innerHTML.trim();s=s.replaceAll(/<p.*>(<img.*>)<\/p>/g,"$1"),!(D(s)===""&&B(s).length===0)&&e.push(s)}),e.join(" ")):""},_=()=>({content:ot(),title:window.elementor.settings.page.model.get("post_title"),excerpt:window.elementor.settings.page.model.get("post_excerpt")||"",slug:A(window.elementor.settings.page.model.get("post_title")),permalink:window.elementor.config.document.urls.permalink||""}),st=()=>{const t=w(ET_Builder,"Frames.app.frameElement",document.querySelector("iframe#et-fb-app-frame"));if(!t)return document.createElement("div");let e=t.contentWindow.document.querySelectorAll("#et-fb-app");return 1<e.length&&(e=[...e].filter(o=>o.classList.contains("et-fb-root-ancestor"))),e[0]||document.createElement("div")},at=()=>{const t=[],e=st().querySelectorAll(".et_pb_section"),o=new RegExp(["<style.*?</style>","\\[object Object\\]"].join("|"),"gi");for(let a=0;a<e.length;a++){let s=e[a].innerHTML;s=e[a].innerHTML.replace(o,""),s=s.replaceAll(/<p.*>(<img.*>)<\/p>/g,"$1"),!(D(s)===""&&B(s).length===0)&&t.push(s)}return t.join(" ")},it=()=>{const t=new URL(w(ETBuilderBackendDynamic,"currentPage.permalink",""));return t.searchParams.delete("PageSpeed"),t.href},b=()=>({content:at(),title:w(ETBuilderBackendDynamic,"postTitle",""),excerpt:w(ETBuilderBackendDynamic,"postMeta.post_excerpt",""),slug:w(ETBuilderBackendDynamic,"postMeta.post_name",""),permalink:it()}),rt=t=>{let e;switch(t.type){case"header":e=document.createElement(t.settings.tag),e.innerHTML=t.settings.headerTxt.trim();break;case"image":const o=document.createElement("img");t.settings.altTxt&&o.setAttribute("alt",t.settings.altTxt),t.settings.src&&o.setAttribute("src",t.settings.src),t.settings.noFollow&&o.setAttribute("rel","nofollow"),e=o,t.settings.link&&(e=document.createElement("a"),e.setAttribute("href",t.settings.link),e.innerHTML=o.outerHTML,t.settings.noFollow&&e.setAttribute("rel","nofollow"),t.settings.openNewWindow&&e.setAttribute("target","_blank"));break;case"video":t.settings.type==="youtube"?(e=document.createElement("iframe"),e.setAttribute("src",t.settings.youtubeUrl)):(e=document.createElement("div"),e.innerHTML=t.settings.code);break;case"text":e=document.createElement("div"),e.innerHTML=t.settings.txt.trim();break;case"button":e=document.createElement("a"),e.appendChild(document.createTextNode(t.settings.btnTxt+" "+t.settings.btnSubTxt)),t.settings.link&&e.setAttribute("href",t.settings.link),t.settings.altTxt&&e.setAttribute("alt",t.settings.altTxt),t.settings.src&&e.setAttribute("src",t.settings.src),t.settings.noFollow&&e.setAttribute("rel","nofollow"),t.settings.openNewWindow&&e.setAttribute("target","_blank");break;case"bullet-list":e=document.createElement("ul"),t.settings.items.forEach(a=>{const s=document.createElement("li");s.innerHTML=a.txt,e.appendChild(s)});break;case"custom-html":e=document.createElement("div"),e.innerHTML=t.settings.code;break}return e},ct=()=>{const t=[];return JSON.parse(JSON.stringify(w(seedprod_data,"settings.document.sections",[]))).forEach(o=>{o.rows.forEach(a=>{a.cols.forEach(s=>{s.blocks.forEach(c=>{const r=rt(c);!r||D(r)===""&&B(r).length===0||t.push(r.outerHTML)})})})}),t.join(" ")},lt=()=>{const t=w(seedprod_data,"home_url",""),e=w(seedprod_data,"settings.post_name","");return`${t}/${e}/`},$=()=>({content:ct(),title:w(seedprod_data,"settings.post_title",""),excerpt:"",slug:w(seedprod_data,"settings.post_name",""),permalink:lt()}),z=()=>{let t="";return S()&&(t=_().permalink),C()&&(t=b().permalink),k()&&(t=$().permalink),t},ut=()=>{if(n.state["live-tags"].liveTags.permalink)return n.state["live-tags"].liveTags.permalink;let t;if(g()||v){const e=document.querySelector("#edit-slug-box a");e&&e.href&&(t=e.href)}return f()&&(t=window.wp.data.select("core/editor").getPermalink()),t||(t=z()),t&&n.commit("live-tags/updatePermalink",t),t},x=()=>{let t;if(g()||v){const e=document.querySelector("#edit-slug-box a");e&&e.href&&(t=e.href)}return f()&&(t=window.wp.data.select("core/editor").getPermalink()),t||(t=z()),t},dt=async(t=!0)=>{let e=ut();const o=x();e!==o&&(e=o,e&&(n.commit("live-tags/updatePermalink",e),t&&y.prototype.$truSeo.runAnalysis({postId:n.state.currentPost.id,postData:{...n.state.currentPost},content:h(),slug:x()})))},W=/base64,(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)/g,G=()=>{let t="";return S()&&(t=_().content),C()&&(t=b().content),k()&&(t=$().content),t},V=t=>{var a;if(!t.includes('<!-- wp:block {"ref":'))return t;const e=(a=window.wp.blocks)==null?void 0:a.rawHandler({HTML:t});return et(e).forEach(s=>{var c,r,d;if(s.name==="core/block"){const i=window.wp.data.select("core").getEntityRecord("postType","wp_block",(c=s.attributes)==null?void 0:c.ref);(r=i==null?void 0:i.content)!=null&&r.raw&&(t=t.replace(`<!-- wp:block {"ref":${(d=s.attributes)==null?void 0:d.ref}} /-->`,i.content.raw))}}),t},Z=()=>{if(n.state["live-tags"].liveTags.post_content)return n.state["live-tags"].liveTags.post_content;let t="";if(g())if(window.tinyMCE||document.querySelector("#wp-content-wrap.html-active"))t=I();else{const e=window.setInterval(()=>{window.tinyMCE&&(window.clearInterval(e),t=I())},50)}return f()&&(t=window.wp.data.select("core/editor").getCurrentPost().content,t=V(t)),t||(t=G()),window.aioseo.currentPost.descriptionIncludeCustomFields&&(t=t+R()),t=t.replace(W,""),t&&n.commit("live-tags/updatePostContent",t),t},h=()=>{let t="";if(g())if(window.tinyMCE||document.querySelector("#wp-content-wrap.html-active"))t=I();else{const e=window.setInterval(()=>{window.tinyMCE&&(window.clearInterval(e),t=I())},50)}return f()&&(t=window.wp.data.select("core/editor").getEditedPostContent(),t=V(t)),t||(t=G()),window.aioseo.currentPost.descriptionIncludeCustomFields&&(t=t+R()),t=t.replace(W,""),t},pt=async(t=!0)=>{let e=Z();const o=h();e!==o&&(e=o,n.commit("live-tags/updatePostContent",e),t&&y.prototype.$truSeo.runAnalysis({postId:n.state.currentPost.id,postData:{...n.state.currentPost},content:h(),slug:x()}))},I=()=>{let t="";const e=window.tinyMCE?window.tinyMCE.get("content"):"";if(document.querySelector("#wp-content-wrap.tmce-active")&&e)t=e.getContent({format:"raw"});else{const o=document.querySelector("textarea#content");t=o?o.value:""}return t},F=()=>{let t="";return S()&&(t=_().title),C()&&(t=b().title),k()&&(t=$().title),t},mt=()=>{if(n.state["live-tags"].liveTags.post_title)return n.state["live-tags"].liveTags.post_title;let t;if(g()||v()){const e=document.querySelector("#post input#title");t=e?e.value:""}return f()&&(t=window.wp.data.select("core/editor").getCurrentPost().title),t||(t=F()),t&&n.commit("live-tags/updatePostTitle",t),t},gt=()=>{let t;if(g()||v()){const e=document.querySelector("#post input#title");t=e?e.value:""}return f()&&(t=window.wp.data.select("core/editor").getEditedPostAttribute("title")),t||(t=F()),t},ft=async(t=!0)=>{let e=mt();const o=gt();e!==o&&(e=o,n.commit("live-tags/updatePostTitle",e),t&&y.prototype.$truSeo.runAnalysis({postId:n.state.currentPost.id,postData:{...n.state.currentPost},content:h(),slug:x()}))},J=t=>{if(!t)return"";const e=[/\[.*?\]/g,/<\/?[a-z][^>]*?>/gi,/<!--[\s\S]*?-->/g,/(\r\n|\n|\r)/g];return t=t.replaceAll(/\n\n/g," "),e.forEach(o=>{t=t.replace(o,"")}),t.trim()},X=()=>{let t="";return S()&&(t=_().excerpt),C()&&(t=b().excerpt),k()&&(t=$().excerpt),t},wt=()=>{if(n.state["live-tags"].liveTags.post_excerpt)return n.state["live-tags"].liveTags.post_excerpt;let t;if(g()||v()){const e=document.querySelector("#postexcerpt textarea#excerpt");t=e?e.value:""}return f()&&(t=window.wp.data.select("core/editor").getCurrentPost().excerpt),t||(t=X()),t||(t=J(Z())),t&&n.commit("live-tags/updatePostExcerpt",t),t},yt=()=>{let t;if(g()||v()){const e=document.querySelector("#postexcerpt textarea#excerpt");t=e?e.value:""}return f()&&(t=window.wp.data.select("core/editor").getEditedPostAttribute("excerpt")),t||(t=X()),t||(t=J(h())),t},vt=async(t=!0)=>{let e=wt();const o=yt();e!==o&&(e=o,n.commit("live-tags/updatePostExcerpt",e),t&&y.prototype.$truSeo.runAnalysis({postId:n.state.currentPost.id,postData:{...n.state.currentPost},content:h(),slug:x()}))},Q=()=>{let t="";return S()&&(t=_().slug),C()&&(t=b().slug),k()&&(t=$().slug),t},Et=()=>{if(n.state["live-tags"].permalinkSlug)return n.state["live-tags"].permalinkSlug;let t="";if(g()||v()){const e=document.querySelector("#post_name");e&&(t=A(e.value))}return f()&&(t=window.wp.data.select("core/editor").getCurrentPost().slug),t||(t=Q()),t&&n.commit("live-tags/updatePermalinkSlug",t),t},ht=()=>{let t="";if(g()||v()){const e=document.querySelector("#post_name");e&&(t=A(e.value))}if(f()&&(t=window.wp.data.select("core/editor").getEditedPostAttribute("slug")),S()){const e=window.elementor.settings.page.model.get("post_title");e&&(t=A(e))}return t||(t=Q()),t},Pt=async(t=!0)=>{let e=Et();const o=ht();e!==o&&(e=o,n.commit("live-tags/updatePermalinkSlug",e),t&&y.prototype.$truSeo.runAnalysis({postId:n.state.currentPost.id,postData:{...n.state.currentPost},content:h(),slug:x()}))};let p="",E="";const Tt=(t=!0)=>{var e;if(g()||v()){const o=document.querySelectorAll('#post input[name="post_category[]"]:checked');o.length?(p!==o[0].parentNode.innerText&&(p=o[0].parentNode.innerText,n.commit("live-tags/updateTaxonomyTitle",p)),E=Array.from(o).map(a=>a.parentNode.innerText).join(", "),n.commit("live-tags/updateCategories",E)):p!==""&&(p=E="",n.commit("live-tags/updateTaxonomyTitle",p),n.commit("live-tags/updateCategories",E))}if(f()){let o=[],a=[];if((e=window.aioseo.user.data.allcaps)!=null&&e.manageCategories&&(o=window.wp.data.select("core").getEntityRecords("taxonomy","category"),a=window.wp.data.select("core/editor").getEditedPostAttribute("categories")),a&&a.length&&o){const s=o.find(c=>c.id===a[0]);s&&p!==s.name&&(p=s.name,n.commit("live-tags/updateTaxonomyTitle",p)),E=o.filter(c=>a.includes(c.id)).map(c=>c.name).join(", "),n.commit("live-tags/updateCategories",E)}else p!==""&&(p=E="",n.commit("live-tags/updateTaxonomyTitle",p),n.commit("live-tags/updateCategories",E))}t&&y.prototype.$truSeo.runAnalysis({postId:n.state.currentPost.id})},xt=(t=!1)=>{if(n.state.currentPost.context!=="term")return;const e=document.querySelector("#edittag input#name");e&&(n.commit("live-tags/updateTaxonomyTitle",e.value),e.addEventListener("input",()=>{n.commit("live-tags/updateTaxonomyTitle",e.value)}));const o=document.querySelector("#edittag textarea#description");o&&(n.commit("live-tags/updateTaxonomyDescription",o.value),o.addEventListener("input",()=>{n.commit("live-tags/updateTaxonomyDescription",o.value)}));const a=document.querySelector("#edittag input#slug");if(a){const s=A(a.value);n.commit("live-tags/updatePermalinkSlug",s),n.commit("live-tags/updatePermalink",n.state.currentPost.permalink.replace(`/${n.state["live-tags"].permalinkSlug}`,`/${s.replace(/ /gi,"-").replace(/[^a-z0-9-]/gi,"").toLowerCase()}`)),a.addEventListener("input",()=>{n.commit("live-tags/updatePermalinkSlug",s),n.commit("live-tags/updatePermalink",n.state.currentPost.permalink.replace(`/${n.state["live-tags"].permalinkSlug}`,`/${s.replace(/ /gi,"-").replace(/[^a-z0-9-]/gi,"").toLowerCase()}`))})}n.dispatch("savePostState"),t&&y.prototype.$truSeo.runAnalysis({postId:n.state.currentPost.id})},St=(t=!1)=>{if(n.state.currentPost.postType!=="attachment")return;const e=document.querySelector("textarea#attachment_caption");e&&(n.commit("live-tags/updateAttachmentCaption",e.value),e.addEventListener("input",r=>{n.commit("live-tags/updateAttachmentCaption",r.target.value)}));const o=document.querySelector("textarea#attachment-details-caption");o&&(n.commit("live-tags/updateAttachmentCaption",o.value),o.addEventListener("input",r=>{n.commit("live-tags/updateAttachmentCaption",r.target.value)}));const a=document.querySelector("textarea#attachment_content");a&&(n.commit("live-tags/updateAttachmentDescription",a.value),a.addEventListener("input",r=>{n.commit("live-tags/updateAttachmentDescription",r.target.value)}));const s=document.querySelector("input#attachment_alt");s&&(n.commit("live-tags/updateAltTag",s.value),s.addEventListener("input",r=>{n.commit("live-tags/updateAltTag",r.target.value)}));const c=document.querySelector("input#attachment-details-alt-text");c&&(n.commit("live-tags/updateAltTag",s.value),c.addEventListener("input",r=>{n.commit("live-tags/updateAltTag",r.target.value)})),t&&y.prototype.$truSeo.runAnalysis({postId:n.state.currentPost.id})};export{ht as a,qt as b,Mt as c,gt as d,x as e,Tt as f,h as g,xt as h,St as i,b as j,_ as k,T as m,j as s,nt as t};
