import{p as a}from"./popup.25df8419.js";import{a as l}from"./WpTable.68e67998.js";import{n as c}from"./_plugin-vue2_normalizer.d86aa1f3.js";import"./index.8eedf1b9.js";import"./SaveChanges.68e73792.js";import{a as r,m as n,b as d}from"./vuex.esm.19624049.js";import{C as p}from"./index.5dd9aaae.js";import{G as u,a as h}from"./Row.67f2b082.js";import{S as m}from"./Checkmark.57e6a235.js";import{W as _,a as y,b as f}from"./Header.5bc3a821.js";import{W as g,a as $}from"./Steps.7006c727.js";import"./params.bea1a08d.js";import"./helpers.a2b0759e.js";import"./attachments.540ad25c.js";import"./cleanForSlug.d330f33d.js";import"./isArrayLikeObject.5268a676.js";import"./constants.a33ff6d4.js";import"./default-i18n.31663a66.js";import"./Caret.2b15c7cb.js";import"./_commonjsHelpers.10c44588.js";import"./html.bcbe747e.js";import"./Index.c4701ef0.js";import"./client.1a03de11.js";import"./translations.b7a6f669.js";import"./portal-vue.esm.c4534d19.js";import"./Logo.a68bde64.js";const k={components:{CoreAlert:p,GridColumn:u,GridRow:h,SvgCheckmark:m,WizardBody:_,WizardCloseAndExit:g,WizardContainer:y,WizardHeader:f,WizardSteps:$},mixins:[l],data(){return{error:null,loading:!1,stage:"license-key",localLicenseKey:null,strings:{enterYourLicenseKey:this.$t.sprintf(this.$t.__("Enter your %1$s License Key",this.$td),"AIOSEO"),boldText:this.$t.sprintf("<strong>%1$s %2$s</strong>","AIOSEO","Lite"),purchasedBoldText:this.$t.sprintf("<strong>%1$s %2$s</strong>","AIOSEO","Pro"),linkText:this.$t.sprintf(this.$t.__("upgrade to %1$s",this.$td),"Pro"),placeholder:this.$t.__("Paste your license key here",this.$td),connect:this.$t.__("Connect",this.$td)}}},watch:{localLicenseKey(s){this.updateLicenseKey(s)}},computed:{...r(["options"]),...r("wizard",{stateLicenseKey:"licenseKey",presetFeatures:"features"}),noLicenseNeeded(){return this.$t.sprintf(this.$t.__("You're using %1$s - no license needed. Enjoy!",this.$td)+" \u{1F642}",this.strings.boldText)},link(){return this.$t.sprintf('<strong><a href="%1$s" target="_blank">%2$s</a></strong>',this.$links.utmUrl("general-settings","license-box"),this.strings.linkText)},tooltipText(){return this.$isPro?this.$t.__("To unlock the selected features, please enter your license key below.",this.$td):this.$t.sprintf(this.$t.__("To unlock the selected features, please %1$s and enter your license key below.",this.$td),this.link)},alreadyPurchased(){return this.$t.sprintf(this.$t.__("Already purchased? Simply enter your license key below to connect with %1$s!",this.$td),this.strings.purchasedBoldText)}},methods:{...n(["getConnectUrl","processConnect","activate"]),...n("wizard",["saveWizard"]),...d("wizard",["updateLicenseKey"]),processConnectOrActivate(){if(this.$isPro)return this.processActivateLicense();this.processGetConnectUrl()},processActivateLicense(){this.error=null,this.loading=!0,this.$store.commit("loading",!0),this.activate(this.localLicenseKey).then(()=>{this.$aioseo.internalOptions.internal.license.expired=!1,this.saveWizard("license-key").then(()=>{this.$router.push(this.getNextLink)})}).catch(s=>{if(this.loading=!1,this.localLicenseKey=null,this.$store.commit("loading",!1),!s||!s.response||!s.response.body||!s.response.body.error||!s.response.body.licenseData){this.error=this.$t.__("An unknown error occurred, please try again later.",this.$tdPro);return}const e=s.response.body.licenseData;e.invalid?this.error=this.$t.__("The license key provided is invalid. Please use a different key to continue receiving automatic updates.",this.$tdPro):e.disabled?this.error=this.$t.__("The license key provided is disabled. Please use a different key to continue receiving automatic updates.",this.$tdPro):e.expired?this.error=this.licenseKeyExpired:e.activationsError?this.error=this.$t.__("This license key has reached the maximum number of activations. Please deactivate it from another site or purchase a new license to continue receiving automatic updates.",this.$tdPro):(e.connectionError||e.requestError)&&(this.error=this.$t.__("There was an error connecting to the licensing API. Please try again later.",this.$tdPro))})},processGetConnectUrl(){this.loading=!0,this.$store.commit("loading",!0),this.getConnectUrl({key:this.localLicenseKey,wizard:!0}).then(s=>{if(s.body.url){if(!s.body.popup)return this.loading=!1,this.$store.commit("loading",!1),window.open(s.body.url);this.openPopup(s.body.url)}})},openPopup(s){a(s,"_self",600,630,!0,["file","token"],this.completedCallback,this.closedCallback)},completedCallback(s){return s.wizard=!0,this.processConnect(s)},closedCallback(s){if(s)return window.location.reload();this.loading=!1,this.$store.commit("loading",!1)},skipStep(){this.saveWizard(),this.$router.push(this.getNextLink)}},mounted(){this.localLicenseKey=this.stateLicenseKey}};var v=function(){var e=this,t=e._self._c;return t("div",{staticClass:"aioseo-wizard-license-key"},[t("wizard-header"),t("wizard-container",[t("wizard-body",{scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"go-back"},[t("router-link",{staticClass:"no-underline",attrs:{to:e.getPrevLink}},[e._v("\u2190")]),e._v(" \xA0 "),t("router-link",{attrs:{to:e.getPrevLink}},[e._v(e._s(e.strings.goBack))])],1),t("div",{staticClass:"spacer"}),t("base-button",{attrs:{type:"gray"},on:{click:e.skipStep}},[e._v(e._s(e.strings.skipThisStep))])]},proxy:!0}])},[t("wizard-steps"),t("div",{staticClass:"header"},[e._v(" "+e._s(e.strings.enterYourLicenseKey)+" ")]),e.$isPro?e._e():t("div",{staticClass:"description",domProps:{innerHTML:e._s(e.noLicenseNeeded)}}),t("div",{staticClass:"license-cta-box"},[t("div",{domProps:{innerHTML:e._s(e.tooltipText)}}),t("br"),t("grid-row",e._l(e.getSelectedUpsellFeatures,function(i,o){return t("grid-column",{key:o,attrs:{sm:"6"}},[t("svg-checkmark"),e._v(" "+e._s(i.name)+" ")],1)}),1)],1),e.$isPro?e._e():t("div",{domProps:{innerHTML:e._s(e.alreadyPurchased)}}),t("form",{staticClass:"license-key"},[t("input",{staticStyle:{display:"none"},attrs:{type:"text",name:"username",autocomplete:"username"}}),t("base-input",{attrs:{type:"password",placeholder:e.strings.placeholder,"append-icon":e.localLicenseKey?"circle-check":null,autocomplete:"new-password"},model:{value:e.localLicenseKey,callback:function(i){e.localLicenseKey=i},expression:"localLicenseKey"}}),t("base-button",{attrs:{type:"green",disabled:!e.localLicenseKey,loading:e.loading},on:{click:e.processConnectOrActivate}},[e._v(" "+e._s(e.strings.connect)+" ")])],1),e.error?t("core-alert",{staticClass:"license-key-error",attrs:{type:"red"},domProps:{innerHTML:e._s(e.error)}}):e._e()],1),t("wizard-close-and-exit")],1)],1)},b=[],L=c(k,v,b,!1,null,null,null,null);const Q=L.exports;export{Q as default};
