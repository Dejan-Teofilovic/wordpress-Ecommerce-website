(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{742:function(e,t,n){"use strict";var i=n(107),o=n.n(i),r=n(108),a=n.n(r),s=n(530),l=n.n(s),c=n(529),u=n.n(c),p=n(534),d=n.n(p),m=n(531),h=n.n(m),f=n(35),b=n.n(f),g=n(12),v=n.n(g),y=n(10),w=n.n(y),k=n(78),E=n.n(k),C=n(109),R=n(47),I=n.n(R),N=n(528),D=n.n(N),_=n(692),O=n.n(_),P=n(1),j=n(637),x=n(77),T=n.n(x),q=n(732),L=n.n(q),S=I()("calypso:popover:util");function M(){var e={};return e.top=window.scrollY,e.left=window.scrollX,e.width=window.innerWidth,e.height=window.innerHeight,e.right=e.left+e.width,e.bottom=e.top+e.height,S("viewport: %o",e),e}var z={top:"bottom",bottom:"top",left:"right",right:"left"},A={top:"right",left:"top",bottom:"left",right:"bottom"},V=M();function U(){V=M()}var B=!1,F=function(){if(B)return S("window events already bound");B=!0,S("bind handlers to `resize` and `scroll` events"),window.addEventListener("resize",U,!0),window.addEventListener("scroll",U,!0)},H=function(){if(!B)return S("window events are not bound");B=!1,S("unbind handlers to `resize` and `scroll` events"),window.removeEventListener("resize",U,!0),window.removeEventListener("scroll",U,!0)},K=function(e,t,n){var i=L()(n),o=t.clientHeight,r=t.clientWidth,a={top:i.top-o,bottom:V.height-i.bottom-o,left:i.left-r,right:V.width-i.right-r},s=e.split(/\s+/),l=T()(s,1)[0],c=T()(s,2)[1],u=function(e,t){for(var n,i=[e,z[e],A[e],z[A[e]]],o=-1/0,r=0,a=i.length;r<a;r++){var s=i[r],l=t[s];if(l>0)return s;l>o&&(o=l,n=e)}return n}(l,a);return c!==u&&c!==z[u]||(c=null),function(e,t,n,i,o,r){for(var a,s="top"===e||"bottom"===e,l=t?[s?"".concat(e," ").concat(t):"".concat(t," ").concat(e),e,s?"".concat(e," ").concat(z[t]):"".concat(z[t]," ").concat(e)]:[e,s?"".concat(e," ").concat(A[e]):"".concat(A[e]," ").concat(e),s?"".concat(e," ").concat(z[A[e]]):"".concat(z[A[e]]," ").concat(e)],c=0,u=o*r,p=0,d=l.length;p<d;p++){var m=l[p],h=W(m,n,i),f=h.left+o,b=h.top+r,g=Math.min(h.top<V.top?b-V.top:V.bottom-h.top,r),v=Math.min(h.left<V.left?f-V.left:V.right-h.left,o),y=v*g;if(y===u)return m;y>c&&(c=y,a=m)}return a}(u,c,t,n,r,o)||e};function W(e,t,n,i){var o=L()(t);if(!o)throw new Error("could not get bounding client rect of Tip element");var r=o.width,a=o.height,s=L()(n);if(!s)throw new Error("could not get bounding client rect of `target`");var l=s.width,c=s.height,u=function(e,t){var n=t.body||t.getElementsByTagName("body")[0],i=t.documentElement||n.parentNode,o=i.clientTop||n.clientTop||0,r=i.clientLeft||n.clientLeft||0,a=window.pageYOffset||i.scrollTop,s=window.pageXOffset||i.scrollLeft;return{top:e.top+a-o,left:e.left+s-r}}(s,document);if(!u)throw new Error("could not determine page offset of `target`");var p={};switch(e){case"top":p={top:u.top-a,left:i&&i.left?u.left+i.left:u.left+l/2-r/2};break;case"bottom":p={top:u.top+c,left:i&&i.left?u.left+i.left:u.left+l/2-r/2};break;case"right":p={top:u.top+c/2-a/2,left:u.left+l};break;case"left":p={top:u.top+c/2-a/2,left:u.left-r};break;case"top left":p={top:u.top-a,left:u.left+l/2-r+15};break;case"top right":p={top:u.top-a,left:u.left+l/2-15};break;case"bottom left":p={top:u.top+c,left:u.left+l/2-r+15};break;case"bottom right":p={top:u.top+c,left:u.left+l/2-15};break;case"left top":p={top:u.top+c/2-a,left:u.left-r};break;case"left bottom":p={top:u.top+c/2,left:u.left-r};break;case"right top":p={top:u.top+c/2-a,left:u.left+l};break;case"right bottom":p={top:u.top+c/2,left:u.left+l};break;default:throw new Error('invalid position "'.concat(e,'"'))}return p}var Y=function(){},J=I()("calypso:popover"),X=new Set,G=function(e){function t(e){var n;return o()(this,t),n=l()(this,u()(t).call(this,e)),b()(d()(n),"isUpdatingPosition",!1),n.setPopoverId(e.id),n.setDOMBehavior=n.setDOMBehavior.bind(d()(n)),n.setPosition=n.setPosition.bind(d()(n)),n.onClickout=n.onClickout.bind(d()(n)),n.onKeydown=n.onKeydown.bind(d()(n)),n.onWindowChange=n.onWindowChange.bind(d()(n)),n.state={show:e.isVisible,left:-99999,top:-99999,positionClass:n.getPositionClass(e.position)},n}return h()(t,e),a()(t,[{key:"componentDidMount",value:function(){this.state.show&&(this.bindEscKeyListener(),this.bindDebouncedReposition(),F())}},{key:"componentWillReceiveProps",value:function(e){if(this.domContext=E.a.findDOMNode(e.context),!e.isVisible)return null;this.setPosition()}},{key:"componentDidUpdate",value:function(e,t){var n=this,i=this.props.isVisible;return!t.show&&this.state.show&&(this.bindEscKeyListener(),this.bindDebouncedReposition(),F()),i!==e.isVisible&&(i?this.show():this.hide()),this.domContainer&&this.domContext&&i?void(this.isUpdatingPosition||(this.debug("requesting to update position after render completes"),requestAnimationFrame(function(){X.has(n.id)&&n.domContainer&&n.domContext&&i?(n.setPosition(),n.isUpdatingPosition=!1):n.isUpdatingPosition=!1}),this.isUpdatingPosition=!0)):null}},{key:"componentWillUnmount",value:function(){this.debug("unmounting .... "),this.unbindClickoutHandler(),this.unbindDebouncedReposition(),this.unbindEscKeyListener(),H(),X.delete(this.id),J("current popover instances: ",X.size)}},{key:"bindEscKeyListener",value:function(){if(!this.props.closeOnEsc)return null;this.debug("adding escKey listener ..."),document.addEventListener("keydown",this.onKeydown,!0)}},{key:"unbindEscKeyListener",value:function(){if(!this.props.closeOnEsc)return null;this.debug("unbinding `escKey` listener ..."),document.removeEventListener("keydown",this.onKeydown,!0)}},{key:"onKeydown",value:function(e){if(27!==e.keyCode)return null;this.close(!0)}},{key:"bindClickoutHandler",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.domContainer;return e?this._clickoutHandlerReference?(this.debug("clickout event already bound"),null):(this.debug("binding `clickout` event"),void(this._clickoutHandlerReference=O()(e,this.onClickout))):(this.debug("no element to bind clickout "),null)}},{key:"unbindClickoutHandler",value:function(){this._clickoutHandlerReference&&(this.debug("unbinding `clickout` listener ..."),this._clickoutHandlerReference(),this._clickoutHandlerReference=null)}},{key:"onClickout",value:function(e){var t=this.domContext&&this.domContext.contains&&!this.domContext.contains(e.target);if(this.props.ignoreContext&&t){var n=E.a.findDOMNode(this.props.ignoreContext);t=t&&n&&n.contains&&!n.contains(e.target)}t&&this.close()}},{key:"bindDebouncedReposition",value:function(){window.addEventListener("scroll",this.onWindowChange,!0),window.addEventListener("resize",this.onWindowChange,!0)}},{key:"unbindDebouncedReposition",value:function(){this.willReposition&&(window.cancelAnimationFrame(this.willReposition),this.willReposition=null),window.removeEventListener("scroll",this.onWindowChange,!0),window.removeEventListener("resize",this.onWindowChange,!0),this.debug("unbinding `debounce reposition` ...")}},{key:"onWindowChange",value:function(){this.willReposition=window.requestAnimationFrame(this.setPosition)}},{key:"setDOMBehavior",value:function(e){if(!e)return this.unbindClickoutHandler(),null;this.debug("setting DOM behavior"),this.bindClickoutHandler(e),this.domContainer=e,this.domContext=E.a.findDOMNode(this.props.context),this.setPosition()}},{key:"getPositionClass",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.position;return"is-".concat(e.replace(/\s+/g,"-"))}},{key:"adjustRtlPosition",value:function(e){if(this.props.isRtl)switch(e){case"top right":case"right top":return"top left";case"right":return"left";case"bottom right":case"right bottom":return"bottom left";case"bottom left":case"left bottom":return"bottom right";case"left":return"right";case"top left":case"left top":return"top right"}return e}},{key:"computePosition",value:function(){if(!this.props.isVisible)return null;var e=this.domContainer,t=this.domContext,n=this.props,i=n.position,o=n.relativePosition;if(!e||!t)return this.debug("[WARN] no DOM elements to work"),null;var r=i;this.debug("position: %o",r),this.props.autoRtl&&(r=this.adjustRtlPosition(r),this.debug("RTL adjusted position: %o",r)),this.props.autoPosition&&(r=K(r,e,t),this.debug("suggested position: %o",r));var a=Object.assign({},function(e,t){var n=L()(t).width;return e.left=Math.max(0,Math.min(e.left,V.width-n)),e}(W(r,e,t,o),e),{positionClass:this.getPositionClass(r)});return this.debug("updating reposition: ",a),a}},{key:"debug",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];J.apply(void 0,["[%s] ".concat(e),this.id].concat(n))}},{key:"setPopoverId",value:function(e){this.id=e||"pop__".concat(Object(P.uniqueId)()),X.add(this.id),this.debug("creating ..."),J("current popover instances: ",X.size)}},{key:"setPosition",value:function(){var e;if(this.debug("updating position"),!(e=this.props.customPosition?Object.assign({positionClass:this.getPositionClass(this.constructor.defaultProps.position)},this.props.customPosition):this.computePosition()))return null;this.willReposition=null,this.setState(e)}},{key:"getStylePosition",value:function(){var e=this.state;return{left:e.left,top:e.top}}},{key:"show",value:function(){var e=this;if(!this.props.showDelay)return this.setState({show:!0}),null;this.debug("showing in %o","".concat(this.props.showDelay,"ms")),this.clearShowTimer(),this._openDelayTimer=setTimeout(function(){e.setState({show:!0})},this.props.showDelay)}},{key:"hide",value:function(){this.unbindClickoutHandler(),this.unbindDebouncedReposition(),this.unbindEscKeyListener(),H(),this.setState({show:!1}),this.clearShowTimer()}},{key:"clearShowTimer",value:function(){if(!this._openDelayTimer)return null;clearTimeout(this._openDelayTimer),this._openDelayTimer=null}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.props.isVisible)return this.debug("popover should be already closed"),null;this.props.onClose(e)}},{key:"render",value:function(){if(!this.state.show)return this.debug("is hidden. return no render"),null;if(!this.props.context)return this.debug("No `context` to tie. return no render"),null;var e=D()("popover",this.props.className,this.state.positionClass);return this.debug("rendering ..."),w.a.createElement(j.a,{className:this.props.rootClassName},w.a.createElement("div",{style:this.getStylePosition(),className:e},w.a.createElement("div",{className:"popover__arrow"}),w.a.createElement("div",{ref:this.setDOMBehavior,className:"popover__inner"},this.props.children)))}}]),t}(y.Component);b()(G,"propTypes",{autoPosition:v.a.bool,autoRtl:v.a.bool,className:v.a.string,closeOnEsc:v.a.bool,id:v.a.string,ignoreContext:v.a.shape({getDOMNode:v.a.function}),isRtl:v.a.bool,isVisible:v.a.bool,position:v.a.oneOf(["top","top right","right","bottom right","bottom","bottom left","left","top left"]),rootClassName:v.a.string,showDelay:v.a.number,onClose:v.a.func,onShow:v.a.func,relativePosition:v.a.shape({left:v.a.number}),customPosition:v.a.shape({top:v.a.number,left:v.a.number,positionClass:v.a.oneOf(["top","right","bottom","left"])})}),b()(G,"defaultProps",{autoPosition:!0,autoRtl:!0,className:"",closeOnEsc:!0,isRtl:!1,isVisible:!1,position:"top",showDelay:0,onClose:Y,onShow:Y});t.a=Object(C.b)(function(e){return{isRtl:document.body.classList.contains("rtl")}})(G)},758:function(e,t,n){"use strict";var i=n(107),o=n.n(i),r=n(108),a=n.n(r),s=n(530),l=n.n(s),c=n(529),u=n.n(c),p=n(534),d=n.n(p),m=n(531),h=n.n(m),f=n(35),b=n.n(f),g=n(109),v=n(34),y=n(12),w=n.n(y),k=n(10),E=n.n(k),C=n(1),R=(n(807),n(677)),I=n(537),N=n.n(I),D=n(627),_=n(30),O=n(819),P=n(528),j=n.n(P),x=n(595),T=n(742),q=function(e){return"HR"===e.tagName},L=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(r))),b()(d()(n),"menu",E.a.createRef()),b()(d()(n),"_setPropsOnChild",function(e){if(null==e)return e;var t=n._onClose.bind(d()(n),e.props.action),i=t;return e.props.onClick&&(i=Object(C.over)([e.props.onClick,t])),E.a.cloneElement(e,{onClick:i})}),b()(d()(n),"_onShow",function(){var e=n.menu.current;n._previouslyFocusedElement=document.activeElement,e&&e.focus()}),b()(d()(n),"_getClosestSibling",function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=n.menu.current,o=i.firstChild,r=i.lastChild;if(t||(o=i.lastChild,r=i.firstChild),e===i)return o;var a=e[t?"nextSibling":"previousSibling"]||r;return q(a)?n._getClosestSibling(a,t):a}),b()(d()(n),"_onKeyDown",function(e){var t,i=e.target,o=!1;switch(e.keyCode){case 9:n.props.onClose(),o=!0;break;case 38:t=n._getClosestSibling(i,!1),o=!0;break;case 40:t=n._getClosestSibling(i,!0),o=!0}t&&t.focus(),o&&e.preventDefault()}),b()(d()(n),"_onClose",function(e){n._previouslyFocusedElement&&(n._previouslyFocusedElement.focus(),n._previouslyFocusedElement=null),n.props.onClose&&n.props.onClose(e)}),n}return h()(t,e),a()(t,[{key:"componentWillUnmount",value:function(){this._previouslyFocusedElement=null}},{key:"render",value:function(){var e=this.props,t=e.popoverComponent,n=e.autoPosition,i=e.className,o=e.context,r=e.customPosition,a=e.isVisible,s=e.popoverTitle,l=e.position,c=e.rootClassName;return E.a.createElement(t,{onClose:this._onClose,onShow:this._onShow,autoPosition:n,className:i,context:o,customPosition:r,isVisible:a,popoverTitle:s,position:l,rootClassName:c},E.a.createElement("div",{ref:this.menu,role:"menu",className:"popover__menu",onKeyDown:this._onKeyDown,tabIndex:"-1"},E.a.Children.map(this.props.children,this._setPropsOnChild,this)))}}]),t}(k.Component);b()(L,"propTypes",{autoPosition:w.a.bool,isVisible:w.a.bool.isRequired,onClose:w.a.func.isRequired,position:w.a.string,className:w.a.string,rootClassName:w.a.string,popoverComponent:w.a.func,popoverTitle:w.a.string,customPosition:w.a.object}),b()(L,"defaultProps",{autoPosition:!0,position:"top",popoverComponent:T.a});var S=L,M=(n(808),function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(r))),b()(d()(n),"state",{isMenuVisible:!1}),b()(d()(n),"popoverContext",E.a.createRef()),b()(d()(n),"handleClick",function(e){var t=n.props.onClick,i=n.state.isMenuVisible;t(e),i?n.hideMenu():n.showMenu()}),b()(d()(n),"hideMenu",function(){return n.toggleMenu(!1)}),b()(d()(n),"showMenu",function(){return n.toggleMenu(!0)}),n}return h()(t,e),a()(t,[{key:"toggleMenu",value:function(e){this.props.disabled||(this.setState({isMenuVisible:e}),this.props.onToggle(e))}},{key:"render",value:function(){var e=this.props,t=e.toggleTitle,n=e.translate,i=e.position,o=e.children,r=e.disabled,a=e.className,s=e.popoverClassName,l=this.state.isMenuVisible,c=j()("ellipsis-menu",a,{"is-menu-visible":l,"is-disabled":r}),u=j()("ellipsis-menu__menu","popover",s);return E.a.createElement("span",{className:c},E.a.createElement(x.a,{ref:this.popoverContext,onClick:this.handleClick,title:t||n("Toggle menu"),borderless:!0,disabled:r,className:"ellipsis-menu__toggle"},E.a.createElement(N.a,{icon:"ellipsis",className:"ellipsis-menu__toggle-icon"})),E.a.createElement(S,{isVisible:l,onClose:this.hideMenu,position:i,context:this.popoverContext.current,className:u},o))}}]),t}(k.Component));b()(M,"propTypes",{translate:w.a.func,toggleTitle:w.a.string,position:w.a.string,disabled:w.a.bool,onClick:w.a.func,onToggle:w.a.func,popoverClassName:w.a.string}),b()(M,"defaultProps",{onClick:C.noop,onToggle:C.noop});var z=Object(v.localize)(M),A=n(533),V=n.n(A),U=(n(809),function(e){function t(){return o()(this,t),l()(this,u()(t).apply(this,arguments))}return h()(t,e),a()(t,[{key:"render",value:function(){var e=j()("external-link",this.props.className,{"icon-first":!!this.props.showIconFirst},{"has-icon":!!this.props.icon}),t=Object(C.assign)({},Object(C.omit)(this.props,"icon","iconSize","showIconFirst","iconClassName"),{className:e,rel:"external"});t.target&&(t.rel=t.rel.concat(" noopener noreferrer"));var n=E.a.createElement(N.a,{className:this.props.iconClassName,icon:"external",size:this.props.iconSize});return E.a.createElement("a",t,this.props.icon&&this.props.showIconFirst&&n,this.props.children,this.props.icon&&!this.props.showIconFirst&&n)}}]),t}(k.Component));b()(U,"defaultProps",{iconSize:18,showIconFirst:!1}),b()(U,"propTypes",{className:w.a.string,href:w.a.string,onClick:w.a.func,icon:w.a.bool,iconSize:w.a.number,target:w.a.string,showIconFirst:w.a.bool,iconClassName:w.a.string});var B=U,F=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(r))),b()(d()(n),"handleMouseOver",function(e){n.props.focusOnHover&&e.target.focus(),n.props.onMouseOver()}),n}return h()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,i=e.href,o=e.icon,r=e.isSelected,a=e.isExternalLink,s=Object(C.omit)(this.props,"icon","focusOnHover","isSelected","isExternalLink","className","itemComponent"),l=j()("popover__menu-item",n,{"is-selected":r}),c=this.props.itemComponent;return a&&i?(c=B,s.icon=!0):i&&(c="a"),E.a.createElement(c,V()({role:"menuitem",onMouseOver:this.handleMouseOver,tabIndex:"-1",className:l},s),o&&E.a.createElement(N.a,{icon:o,size:18}),t)}}]),t}(k.Component);b()(F,"propTypes",{href:w.a.string,className:w.a.string,isSelected:w.a.bool,icon:w.a.string,focusOnHover:w.a.bool,onMouseOver:w.a.func,isExternalLink:w.a.bool,itemComponent:w.a.oneOfType([w.a.func,w.a.string])}),b()(F,"defaultProps",{isSelected:!1,focusOnHover:!0,onMouseOver:C.noop,itemComponent:"button"});var H=n(582),K=n(562),W=n(547),Y=n(541),J=function(e){var t=e.orderId,n=e.siteId,i=e.refundDialog,o=e.createdDate,r=e.refundableAmount,a=e.currency,s=e.labelId,l=e.translate,c=e.moment,u=e.label,p=void 0===u?{}:u,d=function(){return Object(D.a)(r,a)},m=function(){return e.closeRefundDialog(t,n)},h=[{action:"cancel",label:l("Cancel"),onClick:m},{action:"confirm",onClick:function(){return e.confirmRefund(t,n)},isPrimary:!0,disabled:i&&i.isSubmitting,additionalClassNames:i&&i.isSubmitting?"is-busy":"",label:l("Refund label (-%(amount)s)",{args:{amount:d()}})}];return E.a.createElement(H.a,{additionalClassNames:"label-refund-modal woocommerce wcc-root",isVisible:Boolean(i&&i.labelId===s),onClose:m,buttons:h},E.a.createElement(K.a,null,l("Request a refund")),E.a.createElement("p",null,l("You can request a refund for a shipping label that has not been used to ship a package. It will take at least %(days)s days to process.",{args:{days:"dhlexpress"===p.carrier_id?"31":"14"}})),E.a.createElement("dl",null,E.a.createElement("dt",null,l("Purchase date")),E.a.createElement("dd",null,c(o).format("LLL")),E.a.createElement("dt",null,l("Amount eligible for refund")),E.a.createElement("dd",null,d())))};J.propTypes={siteId:w.a.number.isRequired,orderId:w.a.number.isRequired,refundDialog:w.a.object,createdDate:w.a.number,refundableAmount:w.a.number,currency:w.a.string,labelId:w.a.number,closeRefundDialog:w.a.func.isRequired,confirmRefund:w.a.func.isRequired};var X=Object(g.b)(function(e,t){var n=t.orderId,i=t.siteId,o=t.labelId,r=Object(Y.t)(e,n,i),a=Object(Y.j)(e,n,i);return{refundDialog:r?a.refundDialog:{},label:Object(Y.g)(e,n,i,o)}},function(e){return Object(_.b)({closeRefundDialog:W.e,confirmRefund:W.k},e)})(Object(v.localize)(J)),G=n(625),Q=n(640),Z=function(e){var t=e.orderId,n=e.siteId,i=e.reprintDialog,o=e.paperSize,r=e.storeOptions,a=e.labelId,s=e.translate,l=function(){return e.closeReprintDialog(t,n)},c=[{action:"cancel",label:s("Cancel"),onClick:l},{action:"confirm",onClick:function(){return e.confirmReprint(t,n)},isPrimary:!0,disabled:i&&!i.fileData,additionalClassNames:i&&i.isFetching?"is-busy":"",label:s("Print")}];return E.a.createElement(H.a,{isVisible:Boolean(i&&i.labelId===a),onClose:l,buttons:c,additionalClassNames:"label-reprint-modal woocommerce wcc-root"},E.a.createElement(K.a,null,s("Reprint shipping label")),E.a.createElement("p",null,s("If there was a printing error when you purchased the label, you can print it again.")),E.a.createElement("p",{className:"shipping-label__reprint-modal-notice"},s("NOTE: If you already used the label in a package, printing and using it again is a violation of our terms of service and may result in criminal charges.")),E.a.createElement(G.a,{id:"paper_size",valuesMap:Object(Q.a)(r.origin_country),title:s("Paper size"),value:o,updateValue:function(i){return e.updatePaperSize(t,n,i)}}))};Z.propTypes={siteId:w.a.number.isRequired,orderId:w.a.number.isRequired,reprintDialog:w.a.object,paperSize:w.a.string.isRequired,storeOptions:w.a.object.isRequired,labelId:w.a.number,closeReprintDialog:w.a.func.isRequired,confirmReprint:w.a.func.isRequired};var $=Object(g.b)(function(e,t){var n=t.orderId,i=t.siteId,o=Object(Y.t)(e,n,i),r=Object(Y.j)(e,n,i);return{reprintDialog:o?r.reprintDialog:{},paperSize:r.paperSize,storeOptions:o?r.storeOptions:{}}},function(e){return Object(_.b)({closeReprintDialog:W.f,confirmReprint:W.l,updatePaperSize:W.X},e)})(Object(v.localize)(Z)),ee=n(672),te=n(550),ne=function(e){var t=e.orderId,n=e.siteId,i=e.isVisible,o=e.labelIndex,r=e.serviceName,a=e.packageName,s=e.productNames,l=e.canManagePayments,c=e.receiptId,u=e.translate,p=function(){return e.closeDetailsDialog(t,n)},d=[{action:"close",label:u("Close"),onClick:p}];return E.a.createElement(H.a,{additionalClassNames:"label-details-modal woocommerce wcc-root",isVisible:i,onClose:p,buttons:d},E.a.createElement(K.a,{className:"shipping-label__label-details-modal-heading"},E.a.createElement("span",{className:"shipping-label__label-details-modal-heading-title"},u("Label #%(labelIndex)s details",{args:{labelIndex:o+1}})),l&&c?E.a.createElement("a",{href:"".concat(Object(ee.a)(),"/me/purchases/billing/").concat(c),target:"_blank",rel:"noopener noreferrer"},u("Receipt")):null),E.a.createElement("dl",null,E.a.createElement("dt",null,u("Service")),E.a.createElement("dd",null,r),E.a.createElement("dt",null,u("Package")),E.a.createElement("dd",null,a),E.a.createElement("dt",null,u("Items")),E.a.createElement("dd",null,E.a.createElement("ul",null,s.map(function(e,t){return E.a.createElement("li",{key:t},e)})))))};ne.propTypes={siteId:w.a.number.isRequired,orderId:w.a.number.isRequired,isVisible:w.a.bool,serviceName:w.a.string,packageName:w.a.string,productNames:w.a.array,closeDetailsDialog:w.a.func.isRequired,receiptId:w.a.number};var ie=Object(g.b)(function(e,t){var n=t.orderId,i=t.siteId,o=t.labelId,r=Object(Y.t)(e,n,i),a=Object(Y.j)(e,n,i).detailsDialog;return{isVisible:Boolean(r&&a&&a.labelId===o),canManagePayments:Object(te.s)(e,i)}},function(e){return Object(_.b)({closeDetailsDialog:W.c},e)})(Object(v.localize)(ne)),oe={usps:function(e){return"https://tools.usps.com/go/TrackConfirmAction.action?tLabels=".concat(e)},fedex:function(e){return"https://www.fedex.com/apps/fedextrack/?action=track&tracknumbers=".concat(e)},ups:function(e){return"https://www.ups.com/track?loc=en_US&tracknum=".concat(e)},dhlexpress:function(e){return"https://www.dhl.com/en/express/tracking.html?AWB=".concat(e,"&brand=DHL")}},re=function(e){var t=e.tracking,n=e.carrierId,i=e.translate;if(!t)return E.a.createElement("span",null,i("N/A"));var o=oe[n](t);return o?E.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:o},t," ",E.a.createElement(N.a,{icon:"external",size:12})):E.a.createElement("span",null,t)};re.propTypes={tracking:w.a.string,carrierId:w.a.string};var ae=Object(v.localize)(re),se=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(r))),b()(d()(n),"renderRefund",function(e,t,i,o){var r=n.props,a=r.orderId,s=r.siteId,l=r.translate,c="",u=!1;if(t?(c=l("Labels older than 30 days cannot be refunded."),u=!0):"usps"!==i||o||(c=l("USPS labels without tracking are not eligible for refund."),u=!0),u)return E.a.createElement(O.a,{position:"top left",text:c},E.a.createElement("button",{className:"popover__menu-item shipping-label__item-menu-reprint-expired",role:"menuitem",tabIndex:"-1"},E.a.createElement(N.a,{icon:"refund",size:18}),E.a.createElement("span",null," ",l("Request refund")," ")));return E.a.createElement(F,{onClick:function(){n.props.openRefundDialog(a,s,e)},icon:"refund"},l("Request refund"))}),b()(d()(n),"renderReprint",function(e,t){var i=n.props,o=i.orderId,r=i.siteId,a=i.translate;if(t)return E.a.createElement(O.a,{position:"top left",text:a("Label images older than 180 days are deleted by our technology partners for general security and data privacy concerns.")},E.a.createElement("button",{className:"popover__menu-item shipping-label__item-menu-reprint-expired",role:"menuitem",tabIndex:"-1"},E.a.createElement(N.a,{icon:"print",size:18}),E.a.createElement("span",null," ",a("Reprint")," ")));return E.a.createElement(F,{onClick:function(){n.props.openReprintDialog(o,r,e)},icon:"print"},a("Reprint shipping label"))}),b()(d()(n),"renderLabelDetails",function(e){var t=n.props,i=t.orderId,o=t.siteId,r=t.translate;return E.a.createElement(F,{onClick:function(){n.props.openDetailsDialog(i,o,e)},icon:"info-outline"},r("View details"))}),b()(d()(n),"renderPickup",function(e){var t=n.props.translate,i={usps:"https://tools.usps.com/schedule-pickup-steps.htm",fedex:"https://www.fedex.com/en-us/shipping/schedule-manage-pickups.html",ups:"https://wwwapps.ups.com/pickup/request",dhlexpress:"https://mydhl.express.dhl/us/en/schedule-pickup.html#/schedule-pickup#label-reference"};if(!i.hasOwnProperty(e))return null;return E.a.createElement(F,{onClick:function(){window.open(i[e],"_blank")},icon:"external"},t("Schedule a pickup"))}),n}return h()(t,e),a()(t,[{key:"renderCommercialInvoiceLink",value:function(){var e=this.props,t=e.translate,n=e.label.commercialInvoiceUrl;if(!n)return null;return E.a.createElement(F,{onClick:function(){window.open(n)},icon:"print"},t("Print customs form"))}},{key:"render",value:function(){var e=this.props,t=e.label,n=t.labelIndex,i=t.serviceName,o=t.packageName,r=t.productNames,a=t.receiptId,s=t.labelId,l=t.createdDate,c=t.refundableAmount,u=t.currency,p=t.showDetails,d=t.expiryDate,m=t.anonymized,h=t.usedDate,f=t.tracking,b=t.carrierId,g=t.commercialInvoiceUrl,v=e.siteId,y=e.orderId,w=e.translate,k=e.isModal,C=(new Date).getTime(),R=!1,I=!1;(m||h||d&&d<C)&&(R=!0);var N=(new Date).setDate((new Date).getDate()-30);return(m||h||l&&l<N)&&(I=!0),E.a.createElement("div",{className:"shipping-label__item"},E.a.createElement("p",{className:"shipping-label__item-detail"},w("%(service)s label (#%(labelIndex)d)",{args:{service:i,labelIndex:n+1}}),p&&E.a.createElement("span",null,!k&&E.a.createElement(z,{position:"bottom left"},this.renderLabelDetails(s),this.renderPickup(b),this.renderRefund(s,I,b,f),this.renderReprint(s,R),this.renderCommercialInvoiceLink(g)),E.a.createElement(ie,{siteId:v,orderId:y,labelIndex:n,serviceName:i,packageName:o,productNames:r,receiptId:a,labelId:s}),E.a.createElement(X,{siteId:v,orderId:y,createdDate:l,refundableAmount:c,currency:u,labelId:s}),E.a.createElement($,{siteId:v,orderId:y,labelId:s}))),p&&E.a.createElement("p",{className:"shipping-label__item-tracking"},w("Tracking #: {{trackingLink/}}",{components:{trackingLink:E.a.createElement(ae,{carrierId:b,tracking:f})}})))}}]),t}(k.Component);se.propTypes={siteId:w.a.number.isRequired,orderId:w.a.number.isRequired,label:w.a.shape({serviceName:w.a.string.isRequired,labelIndex:w.a.number.isRequired,packageName:w.a.string.isRequired,productNames:w.a.string.isRequired,receiptId:w.a.number.isRequired,labelId:w.a.number.isRequired,createdDate:w.a.string.isRequired,refundableAmount:w.a.number.isRequired,currency:w.a.string.isRequired,showDetails:w.a.bool.isRequired,expiryDate:w.a.string.isRequired,anonymized:w.a.bool.isRequired,usedDate:w.a.string.isRequired,tracking:w.a.string.isRequired,carrierId:w.a.string.isRequired,commercialInvoiceUrl:w.a.string}).isRequired,isModal:w.a.bool.isRequired,openRefundDialog:w.a.func.isRequired,openReprintDialog:w.a.func.isRequired,openDetailsDialog:w.a.func.isRequired};var le=Object(g.b)(null,function(e){return Object(_.b)({openRefundDialog:W.y,openReprintDialog:W.z,openDetailsDialog:W.u},e)})(Object(v.localize)(se)),ce=function(e){function t(){return o()(this,t),l()(this,u()(t).apply(this,arguments))}return h()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.label,n=e.translate,i=t.serviceName,o=t.labelIndex;return E.a.createElement("div",{className:"shipping-label__item"},E.a.createElement("p",{className:"shipping-label__item-detail"},n("%(service)s label (#%(labelIndex)d)",{args:{service:i,labelIndex:o+1}}),E.a.createElement("br",null),n("Purchasing\u2026")))}}]),t}(se);se.propTypes={label:w.a.object.isRequired};var ue=Object(v.localize)(ce),pe=n(639),de=function(e){function t(){var e,n,i;o()(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return i=l()(this,(e=u()(t)).call.apply(e,[this].concat(a))),b()(d()(i),"eventPropsByType",(n={},b()(n,R.a.INTERNAL_NOTE,function(e){return{icon:"aside",heading:(0,i.props.translate)("Internal note"),content:Object(pe.a)(Object(pe.b)(e.content))}}),b()(n,R.a.CUSTOMER_NOTE,function(e){return{icon:"mail",heading:(0,i.props.translate)("Note sent to customer"),content:Object(pe.a)(Object(pe.b)(e.content))}}),b()(n,R.a.LABEL_PURCHASING,function(e){return{icon:"sync",content:E.a.createElement(ue,{label:e,orderId:i.props.orderId,siteId:i.props.siteId})}}),b()(n,R.a.LABEL_PURCHASED,function(e){return{icon:"print",content:E.a.createElement(le,{label:e,orderId:i.props.orderId,siteId:i.props.siteId,isModal:i.props.isModal})}}),b()(n,R.a.LABEL_REFUND_REQUESTED,function(e){var t=i.props.translate;return{icon:"time",content:E.a.createElement("div",null,t("%(service)s label (#%(labelNum)d) refund requested (%(amount)s)",{args:{service:e.serviceName,labelNum:e.labelIndex+1,amount:Object(D.a)(e.amount,e.currency)}}))}}),b()(n,R.a.LABEL_REFUND_COMPLETED,function(e){var t=i.props.translate;return{icon:"refund",content:E.a.createElement("div",null,t("%(service)s label (#%(labelNum)d) refunded (%(amount)s)",{args:{service:e.serviceName,labelNum:e.labelIndex+1,amount:Object(D.a)(e.amount,e.currency)}}))}}),b()(n,R.a.LABEL_REFUND_REJECTED,function(e){var t=i.props.translate;return{icon:"cross-small",content:E.a.createElement("div",null,t("%(service)s label (#%(labelNum)d) refund rejected",{service:e.serviceName,args:{labelNum:e.labelIndex+1}}))}}),b()(n,R.a.REFUND_NOTE,function(e){var t=i.props.translate;return{icon:"credit-card",heading:t("Refund"),content:E.a.createElement("div",null,t("Refunded %(amount)s",{args:{amount:Object(D.a)(e.amount,e.currency)}}),E.a.createElement("br",null),e.reason)}}),b()(n,void 0,function(){return{}}),n)),b()(d()(i),"renderDefaultEvent",function(e){return{icon:"aside",heading:(0,i.props.translate)("Note"),content:e.content}}),i}return h()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.moment,n=e.event,i=(this.eventPropsByType[n.type]||this.renderDefaultEvent)(n),o=i.icon,r=i.heading,a=i.content;return E.a.createElement("div",{className:"order-activity-log__note"},E.a.createElement("div",{className:"order-activity-log__note-meta"},E.a.createElement("span",{className:"order-activity-log__note-time"},t(n.timestamp).format("LT")),o&&E.a.createElement(N.a,{icon:o,size:24})),E.a.createElement("div",{className:"order-activity-log__note-body"},E.a.createElement("div",{className:"order-activity-log__note-type"},r),E.a.createElement("div",{className:"order-activity-log__note-content"},a)))}}]),t}(k.Component);b()(de,"propTypes",{customer_note:w.a.bool,date_created_gmt:w.a.string,note:w.a.string.isRequired}),b()(de,"propTypes",{event:w.a.object}),b()(de,"defaultProps",{event:{}});var me=Object(v.localize)(de),he=n(624),fe=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(r))),b()(d()(n),"onClick",function(){n.props.onClick(n.props.date)}),n}return h()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.count,n=e.date,i=e.isOpen,o=e.moment,r=e.translate,a=o(n,"YYYYMMDD").format("ll"),s=E.a.createElement("div",null,E.a.createElement("h3",null,a),E.a.createElement("small",null,r("%(count)s event","%(count)s events",{count:t,args:{count:t}})));return E.a.createElement("div",{className:"order-activity-log__day"},E.a.createElement(he.a,{onClick:this.onClick,className:"order-activity-log__day-header",expanded:i,header:s,screenReaderText:r("Show notes from %(date)s",{args:{date:a}})},this.props.children))}}]),t}(k.Component);b()(fe,"propTypes",{count:w.a.number.isRequired,date:w.a.string.isRequired,isOpen:w.a.bool.isRequired,onClick:w.a.func.isRequired});var be=Object(v.localize)(fe);var ge=function(e){function t(){var e,n;o()(this,t);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=l()(this,(e=u()(t)).call.apply(e,[this].concat(r))),b()(d()(n),"toggleOpenDay",function(e){n.setState(function(){return{openDay:e}})}),b()(d()(n),"renderNotes",function(){var e=n.props,t=e.days,i=e.eventsByDay,o=e.translate;return t.length?E.a.createElement("div",null,t.map(function(e){var t=i[e];return E.a.createElement(be,{key:e,count:t.length,date:e,isOpen:e===n.state.openDay,onClick:n.toggleOpenDay},t.map(function(e){return E.a.createElement(me,{key:"".concat(e.type,"-").concat(e.key),event:e,orderId:n.props.orderId,siteId:n.props.siteId,isModal:n.props.isModal})}))})):E.a.createElement("p",null,o("No activity yet"))}),b()(d()(n),"renderPlaceholder",function(){return E.a.createElement("div",{className:"is-placeholder"},E.a.createElement(be,{count:0,date:"",isOpen:!0,index:1,onClick:C.noop},E.a.createElement(me,null)))}),n}return h()(t,e),a()(t,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({openDay:Object(C.last)(Object(C.keys)(this.props.eventsByDay))})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=Object(C.last)(Object(C.keys)(e.eventsByDay));this.props.eventsByDay[t]||this.setState({openDay:t})}},{key:"render",value:function(){return this.props.isLoaded?this.renderNotes():this.renderPlaceholder()}}]),t}(k.Component);b()(ge,"propTypes",{orderId:w.a.number.isRequired,siteId:w.a.number.isRequired});t.a=Object(g.b)(function(e,t){var n=t.orderId||!1,i=Object(R.c)(e,n),o=Object(R.b)(e,n),r=o.length?function(e){var t={};return e.forEach(function(e){var n=Object(v.moment)(e.timestamp).format("YYYYMMDD");t[n]?t[n].push(e):t[n]=[e]}),Object(C.keys)(t).forEach(function(e){t[e]=Object(C.sortBy)(t[e],["timestamp","key"]).reverse()}),t}(o):{},a=r?Object(C.keys)(r):[];return a.sort().reverse(),{isLoaded:i,days:a,events:o,eventsByDay:r}})(Object(v.localize)(ge))},807:function(e,t,n){},808:function(e,t,n){},809:function(e,t,n){}}]);